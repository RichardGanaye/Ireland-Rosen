%&LaTeX
\documentclass[11pt,a4paper]{article}
\usepackage[frenchb,english]{babel}
\usepackage[applemac]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[]{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{yfonts}
%\input{8bitdefs}

% marges
\topmargin 10pt
\headsep 10pt
\headheight 10pt
\marginparwidth 30pt
\oddsidemargin 40pt
\evensidemargin 40pt
\footskip 30pt
\textheight 670pt
\textwidth 420pt

\def\imp{\Rightarrow}
\def\gcro{\mbox{[\hspace{-.15em}[}}% intervalles d'entiers 
\def\dcro{\mbox{]\hspace{-.15em}]}}

\newcommand{\D}{\mathrm{d}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\re}{\,\mathrm{Re}\,}
\newcommand{\ord}{\mathrm{ord}}
\newcommand{\legendre}[2]{\genfrac{(}{)}{}{}{#1}{#2}}



\title{Solutions to Ireland, Rosen ``A Classical Introduction to Modern Number Theory''}
\author{Richard Ganaye}

\begin{document}

\maketitle

{\large \bf Chapter 7}

\paragraph{Ex. 7.1}

{\it Use the method of Theorem 1 to show that a finite subgroup of the
multiplicative group of a field is cyclic.
}

\bigskip

A solution is already given in Ex. 4.15

\paragraph{Ex. 7.2}

{\it Find the finite subgroups of $\R^*$ and $\C^*$ and show directly that they are cyclic.
}

\begin{proof}
If $G$ is a finite subgroup of $\R$ or $\C$, and $n = \vert G \vert$, then from Lagrange's Theorem, $x^n = 1$ for all $x \in G$.

$\bullet$ If  $G$ is a finite subgroup of $\R^*$, then the solutions of $x^n=1$ are in $\{-1,1\}$, so $\{1\} \subset G\subset \{-1,1\}$ : 
$G = \{1\}$ or $G = \{-1,1\}$, both cyclic.

$\bullet$ If  $G$ is a finite subgroup of $\C^*$, then $G \subset \mathbb{U}_n = \{e^{2ik\pi/n}\ \vert \ 0 \leq k \leq n-1\}$. As $\vert G \vert = \vert \mathbb{U}_n \vert = n$, then  $G = \mathbb{U}_n \simeq \Z/n\Z$ is cyclic.
\end{proof}

\paragraph{Ex. 7.3}

{\it  Let $F$ a field with $q$ elements and suppose that $q\equiv 1 \pmod n$. Show that for $\alpha \in \F^*$, the equation $x^n = \alpha$ has either no solutions or $n$ solutions.
}

\begin{proof} This is a particular case of Prop. 7.1.2., where $d = n \wedge (q-1) = n$ : the equation $x^n =\alpha$ has solutions iff $\alpha^{(q-1)/n} = 1$. In this case, there are exactly $d = n$ solutions.

We give  here a direct proof.

Let $g$ a generator of $F^*$.  Write $x = g^y, \alpha = g^a$. Then
$$x^n = \alpha \iff g^{ny} = g^a\iff q-1 \mid ny -a.$$

Suppose that there exists $x\in F$ such that $x^n = \alpha$. Then there exists $y\in \Z$ such that $q-1 \mid ny -a$. Since $n \mid q-1$, then  $n \mid a$.
$$q-1 \mid ny -a \iff \frac{q-1}{n} \mid y - \frac{a}{n}\iff y= \frac{a}{n} + k \frac{q-1}{n}, k\in \mathbb{Z}.$$

As  $\frac{a}{n} + (k+n) \frac{q-1}{n} = \frac{a}{n} + k \frac{q-1}{n}, k\in \mathbb{Z}$, the values $k=0,1\cdots,n-1 $ are sufficient :
$$x^n=\alpha \iff y = \frac{a}{n} + k \frac{q-1}{n}, k\in \{0,1,\cdots,n-1\}.$$

Moreover, these solutions are all distinct : if $k,l\in  \{0,1,\cdots,n-1\}$,
\begin{align*}
g^{\frac{a}{n} + k \frac{q-1}{n}} = g^{\frac{a}{n} + l \frac{q-1}{n}} & \Rightarrow g^{(k-l) \frac{q-1}{n}} = 1\\
&\Rightarrow q-1 \mid (k-l) \frac{q-1}{n}\\
& \Rightarrow n \mid k-l \\
&\Rightarrow k\equiv l \ [n] \Rightarrow k=l.
\end{align*}

Conclusion : if  $F$ is a field with $q$ elements and $n \mid q-1$, the equation $x^n = \alpha$ has either no solutions or $n$ solutions in $F$.

Remark : $$\exists x \in F^*, x^n = \alpha \iff n \mid a \iff \alpha^{(q-1)/n} = 1.$$

Indeed, if $x^n = \alpha$ has a solution, we have proved that $n\mid a$, thus $\alpha^{(q-1)/n} = (g^{a/n})^{q-1} = 1$.

Reciprocally, if $\alpha^{(q-1)/n} = 1$, $g^{a.(q-1)/ n }=1$, thus $q-1 \mid a(q-1)/n$, so $ n \mid a$ :  $\alpha = x^n$, with $x = g^{n/a}$.
\end{proof}

\paragraph{Ex. 7.4}

{\it (continuation) Show that the set of $\alpha \in F^*$ such that $x^n = \alpha$ is solvable is a subgroup with $(q-1)/n$ elements.
}

\begin{proof}
Here $n \mid q-1$.

Let $\varphi = F^* \to F^*$ the application defined by $\varphi(x) = x^n$. $\varphi$ is a morphism of groups, and $\ker \varphi$ is the set of solutions of $x^n = 1$.
As $n \mid q-1$, $x^n = 1$ has exactly $n$ solutions (Prop 7.1.1, Corollary2, or Ex 7.3 with $\alpha = 1$). So $\vert \ker \varphi \vert = n$.

Thus $\mathrm{Im} \varphi \simeq F^*/\ker \varphi$ is a subgroup with cardinality $\vert F^* \vert / \vert \ker \varphi \vert = (q-1)/n$, and $\mathrm{Im} \varphi$ is the set of $\alpha$ such that $x^n = \alpha$ is solvable.

Conclusion : the set of $\alpha \in F^*$ such that $x^n = \alpha$ is solvable is a subgroup with $(q-1)/n$ elements.

\end{proof}

\paragraph{Ex. 7.5}

{\it (continuation) Let $K$ be a field containing $F$ such that $[K:F] = n$. For all $\alpha \in F^*$, show that the equation $x^n = \alpha$ has $n$ solutions in $K$. [Hint: Show that $q^n-1$ is divisible by $n(q-1)$ and use the fact that $\alpha^{q-1} = 1$.]

}

\begin{proof}
As $q\equiv 1 \ [n], \frac{q^n-1}{q-1} = 1+q+\cdots+q^{n-1} \equiv 0 \ [n]$, then $n \mid \frac{q^n-1}{q-1} : $
$$q^n-1 = k n (q-1), k \in \mathbb{N}.$$

Since $\alpha \in F^*$, $\alpha^{q-1} = 1$, so $$\alpha^{(q^n-1)/n} = (\alpha^{q-1})^k = 1.$$

As $\vert K \vert = q^n$, Prop. 7.1.2 (or the final remark in Ex.7.3) show that there exists $x \in K^*$ such that $x^n = \alpha$. Then, from Ex.7.3, we know that there exist $n$ solutions in $K$.

Conclusion : if $[K:F] = n$, the equation $x^n = \alpha$ has $n$ solutions in $K$.

\end{proof}

\paragraph{Ex. 7.6}

{\it Let $K \supset F$ be finite fields with $[K:F] = 3$. Show that if $\alpha \in F$ is not a square in $F$, it is not a square in $K$.

}

\begin{proof}
Let $q = \vert F \vert$. Then $\vert K \vert = q^3.$

If the characteristic of $F$ is 2, $q = 2^k$, and for all $x \in F$, $x = x^q = \left (x^{2^{k-1}}\right)^2$. So all elements in $F$ or $K$ are squares.
We can now suppose that the characteristic of $F$ is not 2, and consequently $1 \neq -1$ in $F$.

As $\alpha$ is not a square in $F$, $\alpha^{(q-1)/2} \ne 1$ (Prop. 7.1.2). From  $0 = \alpha^{q-1} - 1 = (\alpha^{(q-1)/2}-1)(\alpha^{(q-1)/2}+1)$, we deduce $\alpha^{(q-1)/2} = -1$. Then 
$$\alpha^{(q^3-1)/2} = (\alpha^{(q-1)/2})^{q^2+q+1} = (-1)^{q^2+q+1} = -1,$$
since $q^2+q+1$ is always odd.

$\alpha^{(q^3-1)/2} \neq 1$ : this implies (Prop. 7.1.2) that $\alpha$ is not a square in $K$.
\end{proof}

\paragraph{Ex. 7.7}

{\it  Generalize Exercise 6 by showing that if $\alpha$ is not a square in $F$, it is not a square in any extension of odd degree and is a square in every extension of even degree.

}

\begin{proof}
Write $q = [K:F]$, and $q = \mathrm{Card}\ F$.

As $\alpha$ is not a square in $F$, the characteristic of $F$ is not 2 (see Ex.7.6), and $\alpha^{(q-1)/2} \ne 1$. Since $\alpha^{q-1} = 1$, $\alpha^{(q-1)/2}= -1$.
$$\alpha^{(q^n-1)/2} =( \alpha^{(q-1)/2})^{1+q+\cdots+q^{n-1}} = (-1)^{1+q+\cdots+q^{n-1}} .$$

$\bullet$ If $n$ is odd, $1 + q +\cdots+q^{n-1} \equiv 1 \pmod 2$, thus $\alpha^{(q^n-1)/2} = -1\ne 1$, and consequently $\alpha$ is not a square in $K$.

$\bullet$ If $n$ is even, as $q$ is odd ($\mathrm{char}(F) \ne 2$), $1 + q +\cdots+q^{n-1} \equiv 0 \pmod 2$, thus $\alpha^{(q^n-1)/2} = 1$, so $\alpha$ is a square in $K$.
\end{proof}

\paragraph{Ex. 7.8}

{\it  In a field with $2^n$ elements, what is the subgroup of squares.
}

\bigskip

Let $F$ a field with $q = 2^n$ elements. 

\bigskip

{\bf Proof 1}
\begin{proof}
$d = (q-1) \wedge 2 = (2^n - 1) \wedge 2 = 1$, thus each $\alpha \in F^*$ verifies $\alpha^{(q-1)/d} = \alpha^{q-1} = 1$. Theorem 7.1.2 show that $\alpha$ is a square in $F$, of exactly one root.
\end{proof}

{\bf Proof 2}
\begin{proof}
For all $x \in F$, $x = x^q = \left (x^{2^{n-1}}\right)^2$. So all elements in $F$ or $K$ are squares.
\end{proof}

\paragraph{Ex. 7.9}

{\it If $K \supset F$ are finite fields, $\vert F \vert = q, \alpha \in F, q\equiv 1 \pmod n$, and $x^n = \alpha$ is not solvable in $F$, show that $x^n = \alpha$ is not solvable in $K$ if $(n,[K:F]) = 1$.
}

\begin{proof}
Let $k = [K:F]$. From hypothesis, $k\wedge n = 1$, so there exist integers $u,v$ such that $uk+vn = 1$.

As $n \mid q-1$, $n \wedge (q-1) = n$, so the hypothesis "$x^n = \alpha$ is not solvable in $F$" implies that $\alpha^{(q-1)/n} \neq 1$ (Prop. 7.1.2).

Write $\omega =\alpha^{(q-1)/n}$, so $\omega \ne 1$ and $\omega^n = 1$.

As $n \mid q-1$, $n \mid q^k - 1$ and
$$\alpha^{(q^k-1)/n} = (\alpha^{(q-1)/n})^{1+q+q^2+\cdots+q^{k-1}} =  \omega^{1+q+q^2+\cdots+q^{k-1}}.$$
Moreover $1+q+\cdots+q^{k-1} \equiv k \pmod n$, and $\omega^n = 1$, so $\alpha^{(q^k-1)/n} = \omega^k$.

If $\omega^k = 1$, then $\omega = \omega^{uk+vn} = (\omega^k)^u (\omega^n)^v = 1$, which is in contradiction with $\omega = \alpha^{(q-1)/n} \ne 1$.

So $\alpha^{(q^k-1)/n} = \omega^k \ne 1$, and consequently the equation $x^n = \alpha$ has no solution in $K$.
\end{proof}

\paragraph{Ex. 7.10}

{\it If $K \supset F$ be finite fields and $[K:F] = 2$. For $\beta \in K$, show that $\beta^{1+q} \in F$ and moreover that every element in $F$ is of the form $\beta^{1+q}$ for some $\beta \in K$.
}

\begin{proof}
If $\beta = 0$, $\beta^{1+q} = 0 \in F$, and if $\beta \in K^*$, $\beta^{q^2-1} = 1$, so $\left(\beta ^{1+q}\right)^{q-1} = 1$, thus $ \beta^{1+q} \in F$ (Prop. 7.1.1, Corollary 1).

Let  $g$ a generator of $K^*$ : $K^* = \{1,g,g^2,\cdots,g^{q^2-2}\}$.

For every in integer $k \in \Z$, 
$$g^k  \in F^* \iff (g^k)^{q-1} = 1 \iff g^{k(q-1)}=1 \iff q^2-1 \mid k(q-1) \iff q+1 \mid k.$$
Thus $F^* = \{1,g^{q+1}, g^{2(q+1)},\cdots, g^{(q-2)(q+1)}\}$. I $\alpha \in F^*$, there exists $i, 0 \leq i \leq q-1$ such that $\alpha = g^{i(q+1)}$.
If we write $\beta = g^i$, then $\alpha = \beta^{1+q}$ (and for $\alpha = 0$, we take $\beta = 0$).

Conclusion : if $K$ is a quadratic extension of $F$ ($F,K$ finite fields), every element in $F$ is of the form $\beta^{1+q}$ for some $\beta \in K$.
\end{proof}

\paragraph{Ex. 7.11}

{\it With the situation being that of Exercise 10 suppose that $\alpha \in F$ has order $q-1$. Show that there is a $\beta \in K$ with order $q^2-1$ such that $\beta^{1+q} = \alpha$.
}

\bigskip

Write $|a|$ the order of an element $a$ in a group $G$. We recall the following lemma :

\bigskip

{\bf Lemma} If $|a| = d$, then for all $i \in \Z$, $| a^i | = \frac{d}{d\wedge i}$.
\begin{proof}
Indeed, for all $k \in \Z$,
$$(a^i)^k=e \iff a^{ik}=e \iff d \mid ik \iff \frac{d}{d \wedge i} \mid \frac{i}{d \wedge i}\,k \iff \frac{d}{d \wedge i} \mid k.$$
\end{proof}
\begin{proof}(Ex. 7.11)

Let $\alpha \in F^*$ with $|a| = q-1$, and $g$ a generator of $K^*$, so $|g| = q^2-1$. We know from exercise 7.10 that there exists an integer i such that $\alpha = g^{i(q+1)}$.

Let $h = g^{q+1}$. As $h^{q-1} = 1$, then $h \in F^*$, and since $|g| = q^2-1$, $|h| = q-1$, so $h$ is a generator of $F^*$.

Note that for all $s\in \Z$, $\alpha = g^{(i+s(q-1))(q+1)}$, since $g^{q^2-1} = 1$.

We will show that we can choose $s$ such that $j = i +s(q-1)$ is relatively prime with $q+1$. Then  $j$ is such that $\alpha = g^{j(q+1)} = h^j$.


$i$ is odd : if not $\alpha$ is an element of the subgroup of squares in $F^*$, so its order divides $(q-1)/2$, in contradiction with $|\alpha| = q-1$.

 $(q-1)\wedge (q+1) \mid 2$. Since $i-1$ is even, there exist integers $s,t$ verifying the BŽzout's equation
$$i-1 = t(q+1)-s(q-1).$$
Then $j = i+s(q-1) = 1 + t(q+1)$ is relatively prime with $q+1$ : $j \wedge (q+1) = 1$.

Moreover, as $\alpha = h^j$, with $|\alpha| = |h| = q-1$, the lemme implies that
$$q-1 = |\alpha| = \frac{q-1}{(q-1)\wedge j},$$
so $(q-1) \wedge j = 1$.
As $(q+1) \wedge j = 1$ and $(q-1) \wedge j = 1$, then $(q^2-1) \wedge j = 1$.

Let $\beta = g^j$ : then $\alpha = \beta^{1+q}$, and using the lemma :
$$|\beta| = |g^j| = \frac{q^2-1}{(q^2-1)\wedge j} = q^2-1.$$
Conclusion :  there exists a $\beta \in K^*$ with order $q^2-1$ such that $\beta^{1+q} = \alpha$.
\end{proof}

\paragraph{Ex. 7.12}

{\it Use Proposition 7.2.1 to show that given a field $k$ and a polynomial $f(x) \in k[x]$ there is a field $K\supset k$ such that $[K:k]$ is finite and $f(x) = a(x-\alpha_1)(x-\alpha_2)\cdots(x-\alpha_n)$ in $K[x]$.
}

\begin{proof}
We show by induction on the degree $n$ of $f$ that for all polynomials $f \in k[x]$ with $\deg(f) = n \geq 1$, there exists a field extension $K$ such that $[K:k]$ is finite, and $f(x)$ splits in linear factors on $K$.

If $n = 1$, $f(x) = ax+b = a(x-\alpha_0)$, where $\alpha_0 = -b/a$ : $K = k$ is suitable.

Suppose that the property is true for all polynomials of degree less than $n$ on an arbitrary field $k$.

Let $f(x) \in k[x], \deg(f) = n$. From propoistion 7.2.1. applied to an irreducible factor of $f$, there exists a field $L, [L:K]<\infty$ and $\alpha \in L$ such that $f(\alpha_1) = 0$. Then $f(x) = (x-\alpha_1) g(x), g(x) \in L[x]$. 

Applying the induction hypothesis in the field $L$ on the polynomial $g \in L[x]$ with $\deg(g) = n-1$, we obtain a field $K, [K:L]<\infty$ such that $g(x) = a(x-\alpha_2)\cdots(x-\alpha_n)$ with $\alpha_i \in K$. So  $f(x) = a(x-\alpha_1)(x-\alpha_2)\cdots(x-\alpha_n)$ splits in linear factors in $K$. The induction is achieved.
\end{proof}

\paragraph{Ex. 7.13}

{\it Apply Exercise 7.12 to $k = \Z/p\Z$ and $f(x) = x^{p^n} -x$ to obtain another proof of Theorem 2.
}

\begin{proof}
Let $f(x) =  x^{p^n} -x$. We know from Ex. 7.12 that there exists a finite extension $K$ of $\F_p$ such that $f$ splits in linear factors on $K$ :
$$f(x) = \prod_{k=1}^{p^n} (x-\alpha_k), \qquad \alpha_1,\ldots, \alpha_{p^n} \in K.$$
The set $k =\{\alpha_1,\cdots,\alpha_{p_n}\} \subset K$ of the roots of $x^{p^n} -x$ is a subfield of $K$ : indeed, if $\alpha, \beta \in k$,
\begin{enumerate}
\item[(a)] $f(1) = 0$, so $1 \in k$
\item[(b)]$(\alpha- \beta)^{p^n} = \alpha^{p^n} - \beta^{p^n} = \alpha - \beta$, so $\alpha - \beta \in k$.
\item[(c)] $(\alpha\beta)^{p^n} = \alpha^{p^n} \beta^{p^n} = \alpha  \beta$, so $\alpha \beta \in k$.
\item[(d)] $(\alpha^{-1})^{p^n} = (\alpha^{p^n})^{-1} = \alpha^{-1}$, so $\alpha^{-1} \in k$ if $\alpha \ne 0$.
\end{enumerate}
As $f'(x) = -1$, $f(x) \wedge f'(x) = 1$, so $f$ has no multiple root, so the cardinality of $k$ is $p^n$.

Let $g(x) \in \F_p[x]$ a factor of $f(x)$, irreducible in $\F_p[x]$, with $d =\deg(g)$. As $g \mid f$, $g$ splits in linear factors in $k[x]$. Let $\alpha$ a root of $g(x)$ in $k$. As $g$ is irreducible on $\F_p$, 
$d = \deg(g) = [\F_p[\alpha] : \F_p]$. Moreover $ n = [k : \F_p] = [k : \F_p[\alpha]]\,[\F_p[\alpha] : \F_p]$, so $d \mid n$.

Reciprocally, suppose that $g$ is any irreducible polynomial in $\F_p[x]$, with $d = \deg(g) \mid n$. Then $K_0 = \F_p[x]/ \langle g\rangle$  contains a root $\alpha$ of $g$, and $[K_0:\F_p] = \deg(g) = d$, so $\alpha^{p^d} = \alpha$.

As $d\mid n$ , then $p^d-1 \mid p^n-1$ and $x^{p^d}-1 \mid x^{p^n}-1$ (Lemma 2,3 in section 1), so
$$x^{p^d} - x \mid x^{p^n}-x.$$
$f(\alpha) = \alpha^{p^n} - \alpha = 0$ and $g$ is the minimal polynomial of $\alpha$, so $g \mid f$.

Conclusion : 
$$ x^{p^n}-x = \prod_{d\mid n} F_d(x),$$
where $F_d(x)$ is the product of the monic irreducible polynomial of degree $d$.
\end{proof}

\paragraph{Ex. 7.14}

{\it  Let $F$ be a field with $q$ elements and $n$ a positive integer. Show that there exist irreducible polynomials in $F[x]$ of degree $n$.
}

\begin{proof}
Leq $F = \F_q$ a field with $q = p^m$ elements, and $n$ a positive integer.

From Theorem 2 Corollary 3, there exists an irreducible polynomial $f(x) \in \F_p[x]$ of degree $nm$. Let $g$ an irreducible factor of $f$ in $\mathbb{F}_q[x]$, and $\alpha$ a root of $g$ in an extension of $\F_q$.

\bigskip

We show that $\F_q \subset \F_p[\alpha]$.

$\F_q$ and $\F_p[\alpha]$ are two subfield of the same finite field $\F_q[\alpha]$. Moreover, $|\F_q| = p^m$, and $|\F_p[\alpha]| = p^{nm} $. As $m\mid n$, $\F_q \subset \F_p[\alpha]$ .

Indeed, for all  $\gamma \in \F_q[\alpha]$,$$ \gamma \in \F_q \Rightarrow  \gamma^{p^m} =  \gamma \Rightarrow  \gamma^{p^{mn}} =  \gamma \Rightarrow  \gamma \in \F_p[\alpha].$$
So $\F_q \subset \F_p[\alpha]$.

\bigskip

We show that $\F_q[\alpha] =  \F_p[\alpha]$.

As $\F_p \subset \F_q$, $\F_p[\alpha] \subset \F_q[\alpha]$.

Let $\beta \in \F_q[\alpha]$ : $\beta = \sum\limits_{i=1}^k a_i\alpha^i$, where $a_i \in \F[q] \subset \F_p[\alpha]$, so $a_i = p_i(\alpha), p_i \in \F_p[\alpha]$. Consequently
$$\beta = \sum\limits_{i=1}^k p_i(\alpha) \alpha^i \in \F_p[\alpha],$$
so $\F_q[\alpha] =  \F_p[\alpha]$.

$$nm = [\mathbb{F}_p[\alpha] : \mathbb{F}_p] = [\mathbb{F}_q[\alpha]:\mathbb{F}_p] = [\mathbb{F}_q[\alpha] : \mathbb{F}_q]\times [\mathbb{F}_q:\mathbb{F}_p] =  [\mathbb{F}_q[\alpha] : \mathbb{F}_q]\times m .$$
Thus  $[\mathbb{F}_q[\alpha] : \mathbb{F}_q] = n$, and $g$ is the minimal polynomial of $\alpha$ on $\F_q$, so $\deg(g) = n$.

Conclusion : if $F$ is a field with $q = p^m$ elements, there exist irreducible polynomials in $F[x]$ of degree $n$ for all positive integers $n$.
\end{proof}

\paragraph{Ex. 7.15}

{\it Let $x^n-1 \in F[x]$, where $F$ is a finite field with $q$ elements. Suppose that $(q,n) = 1$. Show that $x^n-1$ splits into linear factors in some extension field and that the least degree of such a field is the smallest integer $f$ such that $q^f \equiv 1 \pmod n$.

}

\begin{proof}
From exercise 7.12, we know that $x^n-1$ splits into linear factors in some extension field $K$, with $[K:F]<\infty$ :
$$u(x)= x^n-1 = (x-\zeta_0)(x-\zeta_1)\cdots(x-\zeta_{n-1}), \qquad \zeta_i \in K.$$
$u'(x)\wedge u(x) = nx^{n-1} \wedge (x^n-1) = 1$, since $x(nx^{n-1}) - n(x^n-1) = n$, and $n\neq 0$ in the field $F$, since we know from the hypothesis $q \wedge n=1$ that the characteristic $p$ doesn't divide $n$. So the $n$ roots of $x^n-1$ are distinct.

The set $G = \{x \in K \ \vert \ x^n=1\}$ is a subgroup of $K^*$, thus $G$ is cyclic of order $n$. Let $\zeta$ a generator of $G$. Then
$$x^n-1 = (x-1)(x-\zeta)(x-\zeta^2)\cdots(x-\zeta^{n-1}).$$

Let $p(x)$ the minimal polynomial of $\zeta$ on $F$, and $f$ the degree of $p$ :
$$f = \deg(p) = [F[\zeta] : F].$$
So $\mathrm{Card}\, F[\zeta] = q^f$, and since $\zeta \in F[\zeta]^*$, $\zeta^{q^f - 1} -1 = 0$.
As the order of $\zeta$ in the group $G$ is $n$, $n \mid q^f - 1$, namely $q^f \equiv 1 \pmod n$.

\bigskip

Let $k$ any positive integer such that $q^k \equiv 1 \pmod n$.

Then $n \mid q^k - 1$, so $\zeta^{q^k-1} - 1 = 0$, $\zeta^{q^k} - \zeta = 0$. Let $L$ an extension of $K$ such that $x^{q^k} - x$ splits in linear factors in $L$. As $\zeta^{q^k} - \zeta = 0$, $\zeta $ belongs to the subfield $M$ of $L$ with cardinality $q^k$, such that $[M:F]= k$. Thus $\F[\zeta] \subset M$, so $f = [F[\zeta] : F] \leq k = [M:F]$.

$f = [F[\zeta] : F]$ is the smallest $k \in \N^*$ such that $q^k\equiv 1 \pmod n$.

If $K$ is any extension of $F$ containing the roots of $x^n-1$, then $K \supset F[\zeta]$, where $\zeta$ is a primitive root of unity, so $[K : F] \geq [F[\zeta]:F] = f$.

Conclusion : the minimal degree of a extension $K \supset F$ containing the roots of $x^n - 1$, with $n\wedge q = 1$, is the smallest positive integer $f$ such that $q^f \equiv 1 \pmod n$, the order of $q$ modulo $n$.
\end{proof}

\paragraph{Ex. 7.16}

{\it Calculate the monic irreducible polynomials of degree 4 in $\Z/2\Z[x]$.

}

\begin{proof}
Write $F_d$ the product of irreducible monic polynomials in $\mathbb{F}_2[x]$.

Theorem 2 gives $$x^{16}-x=x^{2^4}-x = \prod\limits_{d\mid 4} F_d(x) = F_1(x) F_2(x) F_4(x)$$ 
and 

$$x^{4}-x=x^{2^2}-x = \prod\limits_{d\mid 2} F_d(x) = F_1(x) F_2(x)$$

so $F_4(x) = \frac{x^{16}-x}{x^4-x} = \frac{x^{15}-1}{x^3-1} = x^{12}+x^9+x^6+x^3+1$

$F_4(x) = (x^4+x^3+x^2+x+1)(x^4+x+1)(x^4+x^3+1)$

Among the 16 monic polynomials of degree 4 in $\mathbb{F}_2[x]$, 3 are irreducible :
\begin{align*}
P_1(x) &= x^4+x^3+x^2+x+1,\\
 P_2(x)&=x^4+x+1\\
  P_3(x)&=x^4+x^3+1
\end{align*}

With sage : 
\begin{verbatim}
sage: A = PolynomialRing(GF(2),'x')
sage: x = A.gen()
sage: f = (x^16-x)/(x^4-x)
sage: factor(f)
(x^4 + x + 1) * (x^4 + x^3 + 1) * (x^4 + x^3 + x^2 + x + 1)
\end{verbatim}
\end{proof}

\paragraph{Ex. 7.17}

{\it Let $q$ and $p$ be distinct odd primes. Show that the number of monic irreducibles of degree $q$ in $\Z/p\Z$ is $q^{-1}(p^q -p)$.
}

\begin{proof}
From Theorem 2 Corllary 2, we know that the number of irreducible polynomials on $\F_p$ of degree $q$ is given by
$$N_q = \frac{1}{q}\sum_{d\mid q} \mu\left(\frac{q}{d}\right) p^d.$$
As $q$ is prime, $d$ takes the values $1,q$, with $\mu(1) = 1, \mu(q) = -1$, so
$$N_q = \frac{p^q -p}{q}.$$
\end{proof}

\paragraph{Ex. 7.18}

{\it Let $p$ be a prime with $p\equiv 3 \pmod 4$. Show that the residue classes modulo $p$ in $\Z[i]$ form a field with $p^2$ elements.
}

\begin{proof}
If $p$ is a prime rational integer, with $p\equiv 3 \pmod 4$, then $p$ is a prime in $\Z[i]$.

Indeed, $p$ is irreducibel : if $p = uv,\ u,v \in \Z[i]$, where $u = c+di,v$ are not units, then $p^2 = N(u)N(v),\ N(u)>1,N(v)>1$, so $p = N(u) = u \overline{u} = c^2+d^2$.

 As $c^2\equiv 0,1 \pmod 4, d^2 \equiv 0,1 \pmod 4$, so $p \equiv1 \pmod 4$, which is in contradiction with the hypothesis.
 
 So $p$ is irreducible in $\Z[i]$, and since $\Z[i]$ is a principal ideal domain, $p$ is prime in $\Z[i]$, thus $\Z[i]/( p )$ is a field.
 
 Let $z = a+bi \in \Z[i]$. The Euclidean division of $a,b$ by $q$ gives 
 $$a = qp+r,\ 0\leq r < p, \qquad b = q'p+s, \ 0\leq s < p,$$
 so $$z \equiv r+is \pmod p,\ 0\leq r <p, 0 \leq s < p.$$
 Let's verify that these $p^2$ elements are in differnet classes of congruences modulo $p$.
 
 If $r+is \equiv r'+is' \pmod p$, then $(r-r')/p + i(s-s')/p \in \Z[i]$, so $r\equiv r',s\equiv s' \pmod p$.
 
 As $r,r',s,s'$ are between $0$ and $p-1$, $r=r', s= s'$.
 
 So the cardinality of the field $\Z[i]/( p )$ is $p^2$.
\end{proof}

\paragraph{Ex. 7.19}

{\it Let $F$ be a finite field with $q$ elements . If $f(x) \in F[x]$ has degree $t$, put $|f| = q^t$. Verify the formal identity $\sum_f |f|^{-s} = (1-q^{1-s})^{-1}$. The sum is over all monic polynomials.

}

\begin{proof}
Let $U$ the set of monic polynomials in $\mathbb{F}_q[x]$, and $U_t$ the set of monic polynomials of degree $t$, and $s\in \C$. Then $U = \coprod_{t \in \N} U_t$, so
\begin{align*}
\sum_{f \in U} \vert f \vert^{-s }&= \sum_{t=0}^\infty \sum_{f \in U_t} \vert f \vert^{-s}\\
&=\sum_{t=0}^\infty \frac{1}{q^{ts}} \sum_{f\in U_t} 1
\end{align*}
As $\sum_{f\in U_t} 1 = \mathrm{Card} \, (U_t) = q^t$, then, for $\mathrm{Re}(s) >1$

\begin{align*}
\sum_{f \in U} \vert f \vert^{-s } &= \sum_{t=0}^\infty \frac{1}{q^{t(s-1)}}\\
&=\frac{1}{1-\frac{1}{q^{s-1}}}\\
&= (1-q^{1-s})^{-1}
\end{align*}
As $\left | \frac{1}{q^{t(s-1)}} \right | = \frac{1}{q^{t(\mathrm{Re}(s)-1)}}$, the serie is absolutely convergent for $\mathrm{Re}(s)>1$. This justifies the grouping of terms in this sum.

\bigskip

Conclusion :  if $\mathrm{Re}(s)>1$, 
$$\sum_{f \in U} \vert f \vert^{-s } =(1-q^{1-s})^{-1},$$
where $U$ is the set of monic polynomials in  $\mathbb{F}_q[x]$.
\end{proof}

\paragraph{Ex. 7.20}

{\it With the notation of Exercise 19 let $d(f)$ be the number of monic divisors of $f$ and $\sigma(f) = \sum_{g\mid f} |g|$, where the sum is over the monic divisors of $f$. Verify the following identities :
\begin{enumerate}
\item[(a)] $\sum_f d(f) |f|^{-s} = (1 -q^{1-s})^{-2}$
\item[(b)] $\sum \sigma(f)|f|^{-s} = (1-q^{1-s})^{-1} (1-q^{2-s})^{-1}$
\end{enumerate}

}

\begin{proof}
(a) With the notation of 7.19, for $s \in \mathbb{C}, \mathrm{Re}(s) >1$, $ \sum_{f\in U} \vert f \vert^{-s}$ is absolutely convergent and

$$(1-q^{1-s})^{-1} = \sum_{f\in U} \vert f \vert^{-s}$$

Then
\begin{align*}
(1-q^{1-s})^{-2} &= \sum_{f\in U} \vert f \vert^{-s}\sum_{g\in U} \vert g\vert^{-s}\\
&=\sum_{(f,g)\in U^2} \vert fg\vert^{-s}\\
&= \sum_{h\in U} \sum_{g\in U,\, g\mid h} \vert h \vert^{-s},
\end{align*}
indeed, the application
\[\varphi :
 \left \{
\begin{array}{ccc}
U\times U & \to &   \{(h,g)\in U\times U, g\mid h\}  \\
  (f,g) &   \mapsto &(fg,g)    
\end{array}
\right.
\]
is a bijection.
 
So
 \begin{align*}
 (1-q^{1-s})^{-2} &=\sum_{h\in U}  \vert h \vert^{-s} \mathrm{Card}\{g \in U, g \mid h\}\\
 &= \sum_{h\in U} \vert h \vert^{-s} d(h)\\
 &= \sum_{f\in U} d(f) \vert f \vert^{-s}
 \end{align*}
 
 (b) Similarly,
 \begin{align*}
 (1-q^{1-s})^{-1}  (1-q^{2-s})^{-1} &= \sum_{f\in U} \vert f \vert^{-s} \sum_{g\in U} \vert g \vert^{-s+1}\\
 &=\sum_{(f,g)\in U^2} \vert g \vert\, \vert fg\vert^{-s}\\
 &= \sum_{h\in U} \sum_{g\in U,\, g\mid h} \vert g \vert \, \vert h \vert^{-s}\\
 &=\sum_{h\in U}\vert h \vert ^{-s}  \sum_{g\in U,\, g\mid h} \vert g \vert\\
 &=\sum_{h\in U}  \sigma(h) \vert h \vert ^{-s}\\
  &=\sum_{f\in U}  \sigma(f) \vert f \vert ^{-s}\\
 \end{align*}
\end{proof}

\paragraph{Ex. 7.21}

{\it Let $F$ be a field with $q=p^n$ elements. For $\alpha \in F$ set $f(x) = (x-\alpha)(x-\alpha^p)(x-\alpha^{p^2})\cdots(x-\alpha^{p^{n-1}})$. Show that $f(x) \in \Z/p\Z[x]$. In particular, $\alpha + \alpha^p+\cdots+\alpha^{p^{n-1}}$ and $\alpha\alpha^p\alpha^{p^2}\cdots\alpha^{p^{n-1}}$ are in $Z/p\Z$.

}

\begin{proof}
Let 
$F : 
\left\{
\begin{array}{ccc}
 \mathbb{F}_q &  \to  &  \mathbb{F}_q \\
 x & \mapsto     &  x^p    
\end{array}
\right. .
$


As the characteristic of $\F_q$ is $p$, $(x+y)^p=x^p+y^p$ et $(xy)^p = x^py^p$, and each homomorphism of field is injective, $F$ is a field automorphism (Frobenius automorphism).

For every automorphism $H$ in $\F_q$, and every polynomial $p(x) =\sum a_ix^i \in \F_q[x]$, write $(H.p)(x) = \sum_i H(a_i) x^i$. Then for all $(p,q) \in \F_q[x]^2$, $H.(pq) = (H.p)(H.q)$.

With this notation,
$$f(x) =(x-\alpha)(x-F\alpha)(x- F^2\alpha)\cdots (x-F^{n-1}\alpha),$$
$$(H.f)(x) =(x-F\alpha)(x-F^2\alpha)(x- F^3\alpha)\cdots (x-F^{n}\alpha).$$

Since $\alpha \in \mathbb{F}_{p^n}$, $F^n\alpha = \alpha^{p^n} = \alpha$ , thus
$$H.f = f.$$
In other words, if $f(x) =\sum_i a_i x^i$, then for all $i$, $H(a_i) = a_i$, so $a_i^p = a_i$, thus $a_i \in \F_p$, and $f \in \F_p[x]$.
In particular, the coefficients $a_{n-1}= \alpha + \alpha^p+\cdots+\alpha^{p^{n-1}}, a_0=\alpha\alpha^p\alpha^{p^2}\cdots\alpha^{p^{n-1}}$ are in $\F_p$.
\end{proof}

\paragraph{Ex. 7.22}

{\it (continuation) Set $\mathrm{tr}(\alpha) = \alpha+\alpha^p+\cdots+\alpha^{p^{n-1}}$. Prove that
\begin{enumerate}
\item[(a)] $\mathrm{tr}(\alpha) + \mathrm{tr}(\beta) = \mathrm{tr}(\alpha+\beta)$.
\item[(b)] $\mathrm{tr}(a\alpha) = a\, \mathrm{tr}(\alpha)$ for $a \in \Z/p\Z$.
\item[(c)] There is an $\alpha \in F$ such that $\mathrm{tr}(\alpha) \ne 0$.
\end{enumerate}
}

\begin{proof}
Let $F$ the Frobenius automorphism of $\F_q$ introduced in Ex.7.21.

(a),(b) : If $x,y \in \F_q$, and $a \in \F_p$, then $a^p = a$, so $F(x+y) =(x+y)^p = x^p+y^p = F(x)+F(y)$, and $F(ax) = a^p x^p = a x^p =a F(x)$, so $F$ is $\F_p$-linear, and also $tr = I + F + F^2+\cdots+F^{n-1}$. 

(c) The polynomial $p(x) = x+x^p+x^{p^2}+\cdots+x^{p^{n-1}}$ has degree $p^{n-1}$, so $p(x)$ has at most $p^{n-1}$ roots in $\F_q$, and $|\F_q| =p^n >deg(p) = p^{n-1}$. Therefore there exist in $\F_q$ some element $\alpha$ which is not a root of $p(x)$, and so  $\mathrm{tr}(\alpha) = p(\alpha) \ne 0$.
\end{proof}

\paragraph{Ex. 7.23}

{\it (continuation) For $\alpha \in F$ consider the polynomial $x^p-x-\alpha \in F[x]$. Show that this polynomial is either irreducible or the product of linear factors. Prove that the latter alternative holds iff $\mathrm{tr}(\alpha) = 0$.

}

\begin{proof}
Let $f(x) = x^p -x -\alpha \in F[x]$. There exists an extension $K \supset F$ with finite degree on $F$ which contains a root $\gamma$ of $f$.

As $\gamma^p - \gamma - \alpha = 0$, then for all $i\in \F_p$,
$$(\gamma + i)^p - (\gamma+i) - \alpha = (\gamma^p - \gamma - \alpha) + i^p - i = 0.$$
So $f$ has $n$ distinct roots in $K$ : $\gamma, \gamma+1,\ldots,\gamma+p-1$, and so
$$f(x) = (x-\gamma)(x-\gamma-1)\cdots(x-\gamma-(p-1)).$$
$F[\gamma] $ contains all roots of $f$.

$\bullet$ If $\gamma \in F$, $f(x)$ splits in linear factors in $F$. $f(x)$ is not irreducible, since $\deg(f) = p>1$.

$\bullet$ If $\gamma \not \in F$, we will show that $f$ is irreducible in $F[x]$.

If not, then $f(x) = g(x) h(x)$ is the product of two polynomials $g,h \in F[x]$ such that $1\leq \deg(g) \leq p-1$.

The unicity of the decomposition in irreducible factors in $F[\gamma][x]$ shows that
$$g(x) = \prod_{i\in A} (x-\gamma -i),$$
where $A$ is a subset of $\F_p$, with $A \ne \emptyset, A \ne \F_p$.
As $g(x) \in F[x]$, $\sum\limits_{i\in A} (\gamma+i) = k \gamma +l \in \F_p$, where $1 \leq k = |A| \leq p-1$ and $l = \sum\limits_{i\in A} i \in \F_p$.

So $k\gamma \in \F_p$. Since $\gamma \not \in \F_p$, $k$ is not invertible in $\F_p$, in contradiction with $1\leq k \leq p-1$. Consequently,  $f(x)$ is irreducible.

We conclude that $x^p-x-\alpha \in F[x]$ is irreducible iff $\gamma \not \in F$.

\bigskip

Let $F$ the Frobenius automorphism of $K$ (cf. Ex. 7.21).

$$\alpha = F(\gamma) - \gamma, F(\alpha) = F^2(\gamma) - F(\gamma), \ldots, F^{n-1}(\alpha) = F^n(\gamma) - F^{n-1}(\gamma).$$
The sum of these equalities gives
$$\mathrm{tr}(\alpha) = \alpha+F(\alpha)+\cdots+F^{n-1}(\alpha) = F^n(\gamma) - \gamma = \gamma^{p^n} - \gamma .$$
As the cardinality of $F$ is $q=p^n$,
$$\gamma \in F \iff \gamma^{p^n} - \gamma = 0 \iff \mathrm{tr}(\alpha) = 0.$$

Conclusion : $x^p - x - \alpha$ is irreducible iff $\mathrm{tr}(\alpha) \ne 0$. If $\mathrm{tr}(\alpha)= 0$, $x^p - x - \alpha$ splits in linear factors in $F[x]$.
\end{proof}

\paragraph{Ex. 7.24}

{\it Suppose that $f(x) \in \Z/p\Z[x]$ has the property that $f(x+y) = f(x) + f(y) \in \Z/p\Z[x,y]$. Show that $f(x)$ must be of the form $a_0x +a_1x^p+a_2x^{p^2}+\cdots+a_mx^{p^m}.$
}

\bigskip

{\bf Lemma} {\it If the prime number $p$ divides all binomial coefficients $\binom{n}{1}, \binom{n}{2},\ldots, \binom{n}{n-1}$, then $n$ is a power of $p$.
\begin{proof}
Let $ u(x) = (x+1)^n -x^n - 1 \in \F_p[x]$. Then $f(x) = \sum\limits_{k=1}^{n-1} \binom{n}{i} x^i = 0$.

Write $n = p^a q$, with $p\wedge q = 1$. With a reductio as absurdum, suppose that $q>1$. Then 
$$f(x)= 0 = (x+1)^{p^\alpha q} - x^{p^\alpha q} - 1=(x^{p^\alpha} + 1)^q -x^{p^\alpha q} - 1=\sum\limits_{k=1}^{q-1} \binom{q}{k} x^{kp^a}.$$
Consequently, the coefficient of $x^{p^a}$ is null, so $p \mid q$ : this is absurd. Therefore $q=1$ and $n = p^a$.
\end{proof}


\begin{proof}(Ex. 7.24)

Suppose that $f\in \F_p[x]$ verify in $\F_p[x,y]$ the equality $f(x+y) = f(x)+f(y)$.

Write $f(x) = \sum\limits_{k=1}^d c_i x^i$.
\begin{align*}
0 = f(x+y) - f(x) -f(y)&= \sum_{n=0}^d c_n[(x+y)^n-x ^n - y^n]\\
&=\sum_{n=0}^d \sum_{k=1}^{n-1} c_n\binom{n}{k} x^ky ^{n-k}\\
\end{align*}
So  for all $n$, for all $k$, $1\leq k \leq n-1$, $c_n \binom{n}{k} = 0$ in $\F_p$.

From the lemma, if $n$ is not a power of $p$, there exists a $k$, $1\leq k \leq n-1$ such that $\binom{n}{k} \not \equiv 0 \pmod p$, so $c_n = 0$.
If we write $a_k = c_{p^k}$, then $f(x)$ is of the form
$$f(x) = a_0 x+a_1x^p +a_2 x^{p^2}+\cdots+a_m x^{p^m}.$$
\end{proof}

{ \Large \bf Chapter 8} 

\paragraph{Ex. 8.1}

{\it Let $p$ be a prime and $d=(m,p-1)$. Prove that $N(x^m = a) =\sum \chi(a)$, the sum being over all $\chi$ such that $\chi^d = \varepsilon$.
}

\begin{proof}
Let $d = m\wedge (p-1)$ . we prove that $N(x^m =a) = N(x^d = a)$ for all $d \in \F_p$.

$\bullet$ If $a = 0$, $0$ is the only root of $x^m -a$ or $x^d -a$, so  $N(x^m = a) = N(x^d = a) = 1$.

$\bullet$ If $a \in \F_p^*$ and $x^n = a$ has a solution, then we know from the demonstration of Proposition 4.2.1 that $N(x^n-a) = d = N(x^d-a)$.

$\bullet$ If If $a \in \F_p^*$ and $x^n = a$ has no solution, then (Prop. 4.2.1) $a^{(p-1)/d} \ne 1$, so $x^d = a$ has no solution : $N(x^n-a) = 0 = N(x^d-a)$.

Using Prop. 8.1.5, as $d \mid n$, we obtain
$$N(x^n =a) = N(x^d = a) = \sum_{\chi^d = \varepsilon} \chi(a).$$
\end{proof}

\paragraph{Ex. 8.2, false sentence.}

{\it With the notation of Exercise 1 show that $N(x^m = a) = N(x^d = a)$ and conclude that if $d_i = (m_i,p-1)$, then $\sum_i a_ix^{m_i} = b$ and $\sum_i a_i x^{d_i} = b$ have the same number of solutions.
}

\bigskip

This result is false. I give a counterexample with $p=5$ :  $x + x^3 =0 \in \F_5[x]$ has 3 solutions $0,2,-2$.  As $3\wedge (p-1) = 3 \wedge 4 = 1$, the reduced equation is $x + x = 0$, which has an unique solution $0$. The true sentence is :

\bigskip\paragraph{Ex. 8.2}
{\it With the notation of Exercise 1 show that $N(x^m = a) = N(x^d = a)$ and conclude that if $d_i = (m_i,p-1)$, then $\sum_i a_ix_i^{m_i} = b$ and $\sum_i a_i x_i^{d_i} = b$ have the same number of solutions.
}

\begin{proof}
From Ex. 8.1, we know that
$$N(x^m=a) = \sum_{\chi^d=\varepsilon} \chi(a) = N(x^d=a).$$
Using this result, we obtain
\begin{align*}
N\left(\sum\limits_{i=1}^l a_i x_i^{m_i} = b\right) &= \sum\limits_{a_1u_1+\cdots+a_l u_l= b}\, \prod\limits_{i=1}^l N(x^{m_i} = u_i)\\
&= \sum\limits_{a_1u_1+\cdots+a_l u_l= b}\, \prod\limits_{i=1}^l N(x^{d_i} = u_i)\\
&=N\left(\sum\limits_{i=1}^l a_i x_i^{d_i} = b\right)
\end{align*}
\end{proof}

\paragraph{Ex. 8.3}

{\it Let $\chi$ be a non trivial multiplicative character of $\F_p$ and $\rho$ be the character of order 2. Show that $\sum_t\chi(1-t^2) = J(\chi,\rho)$.[Hint: Evaluate $J(\chi,\rho)$ using the relation $N(x^2 = a) = 1 + \rho(a)$.]

}

\begin{proof}
\begin{align*}
J(\chi,\rho) &= \sum\limits_{a+b=1} \chi(a)\rho(b)\\
&= \sum\limits_{a+b=1}\chi(a)(N(x^2=b) -1)\\
&=\sum\limits_{a+b=1}\chi(a)N(x^2=b) -\sum\limits_{a+b=1}\chi(a)\\
\end{align*}
As $\chi \neq \varepsilon$, 
$$\sum\limits_{a+b=1}\chi(a)= \sum\limits_{a\in\mathbb{F}_p}\chi(a)=0.$$
Let $C = \{x^2 \ \vert\  x \in \mathbb{F}^*\}$ the set of squares in $\F_p^*$ , $\overline{C}$ its complementary in  $\mathbb{F}_p^*$ : 
$$\mathbb{F}_p = \{0\} \cup C \cup \overline{C}.$$
Then 
\begin{align*}
J(\chi,\rho) &= \sum\limits_{a+b=1}\chi(a)N(x^2=b)\\
&= \sum\limits_{a+b=1, b=0}\chi(a)N(x^2=b)+\sum\limits_{a+b=1,b\in C}\chi(a)N(x^2=b)+\sum\limits_{a+b=1,b\in\overline{C}}\chi(a)N(x^2=b)\\
&=\chi(1)+ 2 \sum\limits_{b\in C} \chi(1-b)
 \end{align*}
 (because $N(x^2=b)=0$ if $x \in \overline{C}$, and $N(x^2=b)=2$ if $x\in C$).
 As each $b\in C$ has two roots, and as the set of roots of two distinct $b$ are disjointed,
 $$J(\chi,\rho) = \chi(1) + \sum\limits_{t \in \mathbb{F}_p^*} \chi(1-t^2) = \sum\limits_{t \in \mathbb{F}_p} \chi(1-t^2).$$
 
 Conclusion : if $\chi$ is a non trivial multiplicative character of $\F_p$ and $\rho$  the character of order 2,
 $$ J(\chi,\rho) = \sum_{t\in\F_p}\chi(1-t^2) .$$
\end{proof}

\paragraph{Ex. 8.4}

{\it Show, if $k \in \F_p, k\neq 0$, that $\sum_t \chi(t(k-t)) = \chi(k^2/2^2)J(\chi,\rho)$.

}

\begin{proof}
We know from Ex. 8.3 that  $J(\chi,\rho) = \sum_t \chi(1-t^2)$, so

\begin{align*}²
J(\chi,\rho) &= \sum_{t \in \F_p}\chi(1-t)\chi(1+t)\\
&=\sum_{u \in \F_p} \chi(u) \chi(2-u)\qquad(u = 1-t)\\
&=\chi(2^2) \sum_{u \in \F_p} \chi\left(\frac{u}{2}\right) \chi\left(1-\frac{u}{2}\right)\\
&= \chi(2^2) \sum_{v \in \F_p} \chi(v) \chi(1-v)\qquad(u = 2v)\\
&= \chi(2^2) \chi(k^{-2}) \sum_{w \in \F_p} \chi(kv) \chi(k-kv)\\
&=\chi(2^2/k^2) \sum_{t \in \F_p} \chi(t) \chi(k-t)\qquad(t=kv).
\end{align*}

Conclusion : if $k \in \mathbb{F}^*$, and $\chi$ is a non trivial character, $\rho$ the character of order 2,
$$ \sum_{t\in \F_p}\chi(t(k-t)) = \chi(k^2/2^2) J(\chi,\rho).$$
\end{proof}

\paragraph{Ex. 8.5}

{\it If $\chi^2 \ne \varepsilon$, show that $g(\chi)^2 = \chi(2)^{-2}J(\chi,\rho)g(\chi^2)$. [Hint: Write out $g(\chi)^2$ explicitly and use Exercise 4.]

}

\begin{proof}
Let  $\zeta = e^{2i\pi/p}$.
Using the result of Ex. 8.4, we obtain
\begin{align*}
g(\chi)^2 &= \left(\sum_t \chi(t) \zeta^t \right)\left(\sum_s \chi(s) \zeta^s\right)\\
&=\sum_{s,t} \chi(t)\chi(s) \zeta^{t+s}\\
&=\sum_k\left(\sum_{s+t=k} \chi(t) \chi(s)\right)\zeta^k\\
&=\sum_k\left( \sum_t \chi(t(k-t) \right) \zeta^k\\
&= \chi(-1)\sum_t \chi(t^2) + \sum_{k\neq0} \chi(k^2/2^2) J(\chi,\rho) \zeta^k\\
&= \chi(-1)\sum_t \chi^2(t) + \chi(2)^{-2}  J(\chi,\rho) \sum_{k\neq0} \chi^2(k)  \zeta^k\\
\end{align*}

If $\chi^2 \neq \varepsilon, \sum_t \chi^2(t)=0$, so

$$g(\chi)^2 = \chi(2)^{-2}  J(\chi,\rho) g(\chi^2).$$
\end{proof}

\paragraph{Ex. 8.6}

{\it (continuation) Show that $J(\chi,\chi) = \chi(2)^{-2} J(\chi,\rho)$.

}

\begin{proof}
As $\chi^2 \ne \rho$, Theorem 1 Chapter 8 gives $J(\chi,\chi) = g(\chi)^2/g(\chi^2)$, and Exercise 8.5 gives $g(\chi)^2/g(\chi^2) = \chi(2)^{-2} J(\chi,\rho)$, so
$$J(\chi,\chi) =  \chi(2)^{-2} J(\chi,\rho).$$
\end{proof}

\paragraph{Ex. 8.7}

{\it Suppose that $p\equiv 1 \pmod 4$ and that $\chi$ is a character of order 4. Then $\chi^2 = \rho$ and $J(\chi,\chi) = \chi(-1) J(\chi,\rho)$. [Hint: Evaluate $g(\chi)^4$ in two ways.]

}

\begin{proof}
As $\chi$ is a character of order 4, $\chi^2$ is a character of order 2, and $\rho$ (Legendre's character) is the unique character of order 2, so $\chi^2 = \rho$.

From Prop. 8.3.3 we have
$$g(\chi)^4 = \chi(-1) p J(\chi,\chi) J(\chi,\chi^2)  =  \chi(-1) p J(\chi,\chi) J(\chi,\rho).$$
Squaring the result of Ex. 8.5, we obtain
$$g(\chi)^4 = \chi(2)^{-4} J(\chi,\rho)^2 \left[g(\chi^2)\right]^2.$$
Moreover $\chi(2^4) = \chi^4(2) = \varepsilon(2) = 1$, and $g(\chi^2) = g(\rho) = g$, so $\left[g(\chi^2)\right]^2=g^2 = (-1)^{(p-1)/2} p = p $ (From Prop. 6.3.2 and $p\equiv 1 \pmod 4)$. 

Equating these two result, we obtain 
$$\chi(-1) p J(\chi,\chi) J(\chi,\rho)= J(\chi,\rho)^2 p.$$
As $g(\chi)^4 \ne 0$ since $|g(\chi)|^2 = p$, we have $J(\chi,\rho) \ne 0$, so
$$\chi(-1) J(\chi,\chi) = J(\chi,\rho).$$
$[\chi(-1)]^2 = \chi((-1)^2) = \chi(1) = 1$, so $\chi(-1) = \pm 1$, and $\chi(-1)^{-1} = \chi(-1)$, thus
$$ J(\chi,\chi) = \chi(-1) J(\chi,\rho).$$
\end{proof}

\paragraph{Ex. 8.8}

{\it Generalize Exercise 3 in the following way. Suppose that $p$ is a prime, $\sum_t \chi(1-t^m) = \sum_{\lambda} J(\chi,\lambda)$, where $\lambda$ varies over all characters such that $\lambda^m = \varepsilon$. Conclude that $\left | \sum_t \chi(1-t^m) \right | \leq (m-1)p^{1/2}$.

}

\begin{proof}
For all $y \in \F_p$, write  $A_y =\{x \in \mathbb{F}_p\ \vert \ x^m = y\}$. Then $\vert A_y\vert = N(x^m = y)$.

$\mathbb{F}_p = \coprod\limits_{y \in \mathbb{F}_p} A_y$ is the disjoint union of the $A_y$, so
$$\sum_{t\in \mathbb{F}_p} \chi(1-t^m) = \sum_{y\in \mathbb{F}_p} \sum\limits_{t \in A_y} \chi(1-t^m) = \sum_{y\in \mathbb{F}_p} \vert A_y \vert \chi(1-y) =\sum_{y\in \mathbb{F}_p} N(x^m = y) \chi(1-y).$$
Moreover, $N(x^m=y) = \sum\limits_{\lambda^m = \varepsilon} \lambda(y)$ (Prop. 8.1.5), so
\begin{align*}
\sum_{t\in \mathbb{F}_p} \chi(1-t^m) &= \sum_{y\in \mathbb{F}_p}  \sum_{\lambda^m = \varepsilon} \lambda(y)  \chi(1-y)\\
& =  \sum\limits_{\lambda^m = \varepsilon}  \sum\limits_{x+y=1} \chi(x) \lambda(y)\\
& = \sum\limits_{\lambda^m = \varepsilon} J(\chi,\lambda)
\end{align*}
Conclusion : $$\sum\limits_{t\in \mathbb{F}_p} \chi(1-t^m) = \sum\limits_{\lambda^m = \varepsilon} J(\chi,\lambda).$$

We know that there exist $m$ character whose order divides $m$. As $\chi \ne \varepsilon$, $J(\chi,\varepsilon)=0$, and  $\vert J(\chi,\lambda) \vert = \sqrt{p}$ for every $\lambda \ne \varepsilon$,
$$\left \vert \sum_{t\in \mathbb{F}_p} \chi(1-t^m)\right  \vert \leq \sum_{\lambda^m = \varepsilon, \lambda \neq \varepsilon} \vert J(\chi,\lambda) \vert = (m-1)\sqrt{p}.$$
\end{proof}

\paragraph{Ex. 8.9}

{\it Suppose that $p\equiv 1 \pmod 3$ and that $\chi$ is a character of order 3. Prove (using Exercise 5) that $g(\chi)^3 = p\pi$, where $\pi = \chi(2)J(\chi,\rho)$.
}

\begin{proof}
As $\chi$ is o  character of order 3, $\chi^2\neq \varepsilon$. From Exercise 5, we know that
$$g(\chi)^2 = \chi(2)^{-2} J(\chi,\rho) g(\chi^2).$$
So
$$g(\chi)^3 = \chi(2)^{-2} J(\chi,\rho) g(\chi^2)g(\chi).$$
Recall  (¤8.2) that
$$\overline{g(\chi)} = \sum_t \overline{\chi(t)} \zeta^{-t} = \chi(-1) \sum_t \overline{\chi(-t)} \zeta(-t) = \chi(-1) g(\chi),$$
Here $\chi(-1) = 1$, because $\chi(-1) = \chi((-1)^3) = \chi^3(-1) = \varepsilon(-1) = 1$.
Hence
$$g(\chi^2) g(\chi) = g(\bar{\chi}) g(\chi) =\overline{g(\chi)} g(\chi) = \vert g(\chi) \vert^2 =p.$$
Moreover $\chi(2)^3 = \chi^3(2) = 1$, so $\chi(2)^{-2} = \chi(2)$.

\medskip

Conclusion : if $\chi$ is a character of order 3,
 $$g(\chi)^3 = p \pi, \ \mathrm{where}\ \pi = \chi(2) J(\chi,\rho).$$
\end{proof}

\paragraph{Ex. 8.10}

{\it (continuation) Show that $\chi \rho$ is a character of order 6 and that $$g(\chi \rho)^6 = (-1)^{(p-1)/2} p \overline{\pi}^4$$.
}

\begin{proof}
$(\chi \rho)^6 = \chi^6 \rho^6 = \varepsilon, (\chi \rho)^2 = \chi^2 \neq \varepsilon, (\chi \rho)^3 = \rho^3 = \rho \neq \varepsilon$, so  $\chi \rho$ is of order 6.

$J(\chi,\rho) g(\chi \rho) = g(\chi) g(\rho)$ since $\chi, \rho, \chi \rho$ are non trivial characters. So
$$g(\chi \rho)^6 = \frac{g(\chi)^6 g(\rho)^6}{J(\chi, \rho)^6}.$$
From Exercise 8.9, $g(\chi)^6 = p^2 \pi^2$. Proposition 6.3.2 gives $g(\rho)^2 = (-1)^{(p-1)/2} p$, so $g(\rho)^6 =  (-1)^{(p-1)/2} p^3$. 
As $\pi = \chi(2) J(\chi,\rho)$,  $J(\chi,\rho)^6 = \chi(2)^{-6} \pi^6 = \pi^6$, since $\chi(2)^3=1$. Therefore
 $$g(\chi \rho)^6 = \frac{p^2 \pi^2 (-1)^{(p-1)/2} p^3}{\pi^6} = (-1)^{(p-1)/2} p^5 \pi^{-4}.$$
 Moreover, $\pi \bar{\pi} = \chi(2) \overline{\chi(2)} J(\chi,\rho) \overline {J(\chi,\rho)} = \vert J(\chi,\rho) \vert^2 =p$ (Theorem 8.1, Corollary), so $ \pi^{-1} = \bar{\pi}/p$. In conclusion,
$$g(\chi \rho)^6 = (-1)^{(p-1)/2} p \bar{\pi}^4.$$
\end{proof}

\paragraph{Ex. 8.11}

{\it Use Gauss' theorem to find the number of solutions to $x^3+y^3 = 1$ in $\F_p$ for $p=13,19,37$, and $97$.
}

\begin{proof}
$\bullet$ $p = 13$.

 $4 \times 13 = 52 =(-5)^2+27\times 1^2$, where $-5 \equiv 1 \pmod 3$, so $A = -5$.

If $p=13$, $N(x^3+y^3=1) = p-2+A = 13 - 2  - 5 = 6$ : the solutions are only the trivial solutions.

\medskip

$\bullet$ $p=19$.

$4 \times 19 = 76 = 7^2+27\times 1^2$, where $7\equiv1 \pmod 3$, so $A = 7$.

If $p = 19$, $N(x^3+y^3 = 1) = 19 -2 + 7 = 24$.

\medskip

$\bullet$ $p=37$.

$4\times 37 = 148 = (-11)^2 + 27 \times 1^2$, where $-11 \equiv 1 \pmod 3$, so $A = -11$.

If $p=37$, $N(x^3+y^3 = 1) = 37 - 2 -11 = 24$.

\medskip

$\bullet$ $p=97$.

$4 \times 97 = 388 = 19^2 + 27 \times 1^2$, where $19 \equiv 1 \pmod 3$, so $A = 19$.

If $p=97$, $N(x^3+y^3=1) = 97 - 2 + 19 = 114$.

(These results were verified on pari/gp).)
\end{proof}

\paragraph{Ex. 8.12}

{\it If $p\equiv 1 \pmod 4$, then we have seen that $p = a^2+b^2$ with $a,b \in \Z$. If we require that $a$ and $b$ are positive, that $a$ be odd, and that $b$ is even, show that $a$ and $b$ are uniquely determined. (Hint: Use the fact that unique factorization holds in $\Z[i]$ and that if $p = a^2+b^2$ then $a+bi$ is a prime in $\Z[i]$.)
}

\begin{proof}
Suppose that $p$ is prime, $p\equiv 1 \pmod 4$, and $p = a^2+b^2 = c^2+d^2$, where $a,b,c,d$ are positive integers, $a,c$ odd, $b,d$ even. We will show that $a=c, b=d$.

As $p = N(a+bi)$, $\pi = a+bi$ is irreducible in $\Z[i]$ : indeed $\pi = uv$ implies that $p=N(\pi) = N(u)N(v)$, so $N(u)= 1$ or $N(v) = 1$, and $u$ or $v$ is an unit.

Since $\Z[i]$ is a principal ideal domain, $\pi$ is a prime in $\Z[i]$.

$(a+bi)(a-bi) = (c+di)(c-di)$, so the prime $\pi$ divides $c+di$, or it divides $c-di$.

As $N(\pi) = N(c+di) = N(c-di)$, the quotient is an unit. Therefore $\pi$ is an associate of $c+di$ or $c-di$. Since the units in $\Z[i]$ are $1,-1,i,-i$,
$$a+bi = \pm (c+di),\ \mathrm{or}\ a+bi = \pm i (c+di), \ \mathrm{or}\ a+bi = \pm (c-di), \ \mathrm{or}\ a+bi = \pm i(c-di).$$
In all cases, $a=\pm c, b = \pm d$, or $a=\pm d, b = \pm c$.
Since $a,b,c,d$ are positive, $a=c, b=d$, or $a=d,b=c$.
As $ac$ are odds, and $b,d$ even, $a=c, b=d$ : the unicity of the decomposition is proved.
\end{proof}

\paragraph{Ex. 8.13}

{\it If $p\equiv 1 \pmod 3$, we have seen that $4p = A^2+27B^2$, with $A,B \in \Z$. If we require that $A\equiv 1 \pmod 3$, show that $A$ is uniquely determined. (Hint: Use the fact that unique factorization holds in $\Z[\omega]$. This proof is a little trickier than that for Exercise 12.)
}

\begin{proof}
Suppose that $4p = A^2 + 27 B^2 = C^2 + 27 D^2$, where $A \equiv C \equiv 1 \pmod 3$. We will show that $A = C$.

Let $\omega = e^{2i\pi/3} = -1/2 + i \sqrt{3}/2$. Then $i\sqrt{3} = 2 \omega +1$, and for all $x,y$,
$x^3 + 3 y^2 = (x+i\sqrt{3}y)(x-i\sqrt{3}y) = (x + (2\omega+1)y)(x - (2\omega+1)y),$
$$x^2+3y^2 = (x+y+2jy)(x-y-2jy).$$
With $x =A, y = 3B$, we obtain
$$4p = A^2+27B^2 = (A+3B+6\omega B)(A-3B-6\omega B).$$
Note that $A,B$ are of same parity, since $4p = A^2 + 27 B^2$.

So we can write $p = ((A+3B)/2 + 3\omega B)((A-3B)/2 - 6\omega B)$ :
$$p = \pi \overline{\pi},\ \mathrm{where}\ \pi = \frac{A+3B}{2} + 3\omega B \in \Z[\omega].$$
$\pi$ is a prime in $\Z[\omega]$ : indeed $\pi = uv,\ u,v \in \Z[\omega]$ implies $p = N(\pi) = N(u)N(v)$, then $N(u) = 1$ or $N(v) = 1$, $u$ or $v$ is an unit, so $\pi$ is irreducible in the principal ideal domain $\Z[\omega]$, thus $\pi$ is a prime in $\Z[\omega]$.
$$\pi \overline{\pi} = \left(\frac{A+3B}{2} + 3\omega B\right)\left(\frac{A-3B}{2} - 3\omega B\right)=\left(\frac{C+3D}{2} + 3\omega D\right)\left(\frac{C-3D}{2} - 3\omega D\right).$$
As $\pi$ is a prime, it divides $\frac{C+3D}{2} + 3\omega D$ or its conjugate. Since they have the same norm $p$, they are associated. The units of $\Z[\omega]$ are $\pm1,\pm j,\pm j^2$, so there exists $12$ cases :
\begin{align*}
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C+3D}{2} + 3\omega D\right)\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C+3D}{2} + 3\omega D\right)\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C+3D}{2} + 3\omega D\right)\\
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C-3D}{2} - 3\omega D\right)\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C-3D}{2} - 3\omega D\right)\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C-3D}{2} - 3\omega D\right)\\
\end{align*}
If we replace $D$ by $-D$, we obtain the 6 last cases from the 6 first cases, so it is sufficient to examine the first 6 cases. Recall that $(1,\omega)$ is a $\Z$-base of $\Z[\omega]$.
\begin{enumerate}
\item[1)] $A + 3B + 6\omega B = C + 3D + 6\omega D$.

Then $B = D$ and $A+3B = C + 3D$, so $A = C$, which is the expected result.
The five other cases are impossible :
\item[2)] $A+3B + 6\omega B = -C-3D -6\omega D$.

Then $B = -D, A = -C$. As $A\equiv C \equiv 1 \pmod 3$, this is impossible.
\item[3)] $A + 3 B + 6\omega B = \omega(C+3D+6\omega D) = \omega(C+3D) + (-1 - \omega) 6 D = -6D + \omega(C-3D)$.

Then $A+3B = - 6 D$, $A \equiv 0 \pmod 3$, this is impossible.
\item[4)] $A+3B + 6 \omega B = -\omega (C+3D+6\omega D) = -\omega (C+3D) + (1+\omega) 6D = 6D + \omega(-C+3D)$.

Then $A+3B = -6D$, $A \equiv 0 \pmod 3$, this is impossible.

\item[5)] $A+3B + 6\omega B = \omega^2(C+D+6\omega D) = (-1-\omega)(C + 3D) + 6D  = -C + 3D + \omega (-C-3D)$.
Then $A+3B = - C +3D$, $A\equiv -C \pmod 3$ , this is impossible.

\item[6)] $A + 3B + 6 \omega B = -\omega^2(C+3D + 6\omega D) = (1 + \omega)(C+3D) - 6D = (C-3D) + \omega(C+3D)$.

Then $6B = C+ 3D$, $C \equiv 0 \pmod 3$, this is impossible.
\end{enumerate}
In conclusion $A = C$.
\end{proof}

\paragraph{Ex. 8.14}

{\it Suppose that $p\equiv 1 \pmod n$ and that $\chi$ is a character of order $n$. Show that $g(\chi^n) \in\Z[\zeta]$, where $\zeta = e^{2\pi i/n}$.
}

\begin{proof}
From Proposition 8.3.3 we know that
$$g(\chi)^n = \chi(-1) p J(\chi,\chi) J(\chi, \chi^2) \cdots J(\chi, \chi^{n-2}).$$
Let $\mathbb{U}_n =\{x \in \C\ | \ x^n = 1\} = \{1, \zeta, \ldots, \zeta^{n-1}\}$, with $\zeta = e^{2\pi i/n}$, the group of $n$-th roots of unity. As the order of $\chi$ is $n$, for all $x \in \F_p^*$, $(\chi(x))^n = \chi^n(x) = \varepsilon(x) = 1$, so $\chi(x) \in \mathbb{U}_n$, and also $\chi^k(x) = (\chi(x))^k$.

Therefore $J(\chi,\chi^k) = \sum\limits_{x+y=1} \chi(x) \chi^k(x) \in \Z[\zeta]$. Moreover $\chi(-1) = \pm 1$, so $\chi(-1)$ and $p$ are in $\Z[\zeta]$. In conclusion $g(\chi^n) \in \Z[\zeta]$.
\end{proof}

\paragraph{Ex. 8.15}

{\it Suppose that $p\equiv 1 \pmod 6$ and let $\chi$ and $\rho$ be characters of order 3 and 2, respectively. Show that the number of solutions to $y^2 = x^3 + D$ in $\F_p$ is $p+\pi+\overline{\pi}$, where $\pi = \chi \rho(D) J(\chi\rho)$. If $\chi(2) = 1$, show that the number of solutions to $y^2 = x^3 + 1$ is $p+A$, where $4p = A^2+27B^2$ and $A\equiv 1 \pmod 3$. Verify this result numerically when $p=31$.
}

\begin{proof}
$x \mapsto -x$ is a bijection between the set of roots of $x^3 = b$ and the set of roots of $(-x)^3 = b$, so $N(x^3 = b) = N((-x)^3 = b) = N(x^3 = -b)$. 

As $\chi$ is a character of order 3, the characters whose order divides 3 are $\varepsilon,\chi,\chi^2$. Using Prop. 8.1.5, we obtain
\begin{align*}
N(y^2=x^3+D)  &= \sum\limits_{a+b=D} N(y^2=a) N((-x)^3 = b)\\
&= \sum\limits_{a+b=D} N(y^2=a) N(x^3=b)\\
&= \sum\limits_{a+b=D}(1+\rho(a))(1+\chi(b)+\chi^2(b))\\
&=\sum\limits_{i=0}^1\sum\limits_{j=0}^2\sum\limits_{a+b=D} \rho^i(a) \chi^j(b)\\
&=\sum\limits_{i=0}^1\sum\limits_{j=0}^2\rho(D)^i \chi(D)^j\sum\limits_{a'+b'=1} \rho^i(a') \chi^j(b')\qquad (a = Da', b = D b')\\
&=\sum\limits_{i=0}^1\sum\limits_{j=0}^2\rho(D)^i \chi(D)^j J(\chi^j,\rho^i)\\
\end{align*}
We know (Theorem 1) that  $J(\chi,\varepsilon)=J(\chi^2,\varepsilon)=J(\varepsilon,\rho)=0, J(\varepsilon,\varepsilon)=p$, so
$$N(y^2=x^3+D) = p + \rho(D)\chi(D) J(\chi,\rho) + \rho(D) \chi^2(D) J(\chi^2,\rho).$$
As $\chi^2(D) = \chi^{-1}(D) = \overline{\chi(D)}$, and as $\overline{\rho(D)} = \rho(D)$, then $J(\chi^2,\rho) =  J(\overline{\chi},\overline{\rho}) = \overline{J(\chi,\rho)}$, and
$$N(y^2 = x^3+D) = p +\pi + \bar{\pi},\ \mathrm{where}\ \pi = (\rho \chi)(D) J(\chi,\rho).$$

If  $\chi(2)=1$, then from Exercise 8.6 we have
$$J(\chi,\chi) = \chi(2)^{-2} J(\chi,\rho) = J(\chi,\rho).$$
With $D = 1$ (if $\chi(2)=1$), we obtain
$$N(y^2=x^3+1) = p+\pi +\bar{\pi}, \pi = J(\chi,\rho) = J(\chi,\chi).$$
From Prop. 8.3.4 we know that  $J(\chi,\chi) = a + b\omega, b\equiv0 \pmod 3, a \equiv-1\pmod 3$.

$ \pi+ \overline{\pi} = 2\, \mathrm{Re}\, J(\chi,\chi) =2a-b \equiv 1 \pmod 3$, and $p = N(J(\chi,\rho)) = a^2-ab+b^2$, so $4p =(2a-b)^2 + 3b^2$.

Writing $A=2a-b, B=b/3$, we obtain $4p = A^2+27B^2,A\equiv1 \pmod 3$ (the unicity of $A$ if proved in Exercise 8.13).

Conclusion : $N(y^2=x^3+1) = p+A$, where $4p = A^2+27B^2, A\equiv1 \pmod 3$.

\bigskip

If $p=31$, 3 is a primitive element, and $2 = 3^{24} = (3^8)^3$ in $\F_{31}$, therefore $\chi(2)=1$.

$31 = 4 + 27$, $4\times31 = 124 = 4^2+27\times2^2$, and $4\equiv 1 \pmod 3$, so

if $p=31$, $N(y^2 = x^3+1) = 35$.
\end{proof}

\paragraph{Ex. 8.16}

{\it Suppose that $p\equiv 1 \pmod 4$ and that $\chi$ is a character of order 4. Let $N$ be the number of solutions to $x^4+y^4 = 1$ in $\F_p$. Show that $N = p+1-\delta_4(-1) 4 + 2\, \mathrm{Re}\, J(\chi,\chi) + 4 \, \mathrm{Re}\, J(\chi,\rho)$.
}

\begin{proof}
Let $\chi$ a character of order 4 : such a character exists since $p\equiv 1 \pmod 4$. Then

\begin{align*}
N(x^4+y^4=1) &=\sum\limits_{a+b=1} N(x^4=a)N(y^4=b)\\
&=\sum\limits_{a+b=1} \sum\limits_{i=0}^3 \chi^i(a) \sum\limits_{j=0}^3 \chi^j(b)\\
&= \sum\limits_{i=0}^3 \sum\limits_{j=0}^3\sum\limits_{a+b=1} \chi^i(a)  \chi^j(b)\\
&= \sum\limits_{i=0}^3 \sum\limits_{j=0}^3 J(\chi^i,\chi^j)\\
&= p-\chi(-1)-\chi^2(-1) - \chi^3(-1) \\
&+ J(\chi,\chi) + J(\chi,\chi^2) +J(\chi^2,\chi)\\
&+J(\chi^2,\chi^3)+J(\chi^3,\chi^2)+J(\chi^3,\chi^3),
\end{align*}
since from Theorem 1, we have $J(\varepsilon,\varepsilon) = p, J(\varepsilon,\chi^j) = 0$ for $j = 1,2,3$, and $J(\chi^i, \chi^{4-i}) = -\chi^i(-1)$.

Moreover
 $$-[\chi(-1)+\chi^2(-1)+\chi^3(-1)] = 1-[1+\chi(-1)+\chi^2(-1)+\chi^3(-1)],$$
 
 and
 $$
\left\{
\begin{array}{ccll}
  1+\chi(-1)+\chi^2(-1)+\chi^3(-1) = \frac{1-\chi^4(-1)}{1-\chi(-1)} & = 0&\ \mathrm{if}\ \chi(-1) \neq 1    \\
  &     =4&\ \mathrm{if}\ \chi(-1) =1.
\end{array}
\right.
$$

 Let $g$ a generator of $\F_p^*$. Recall that  $\chi(g) = e^{qi\pi/2}$ with $q$ odd, so $\chi : a = g^k \mapsto e^{i qk\pi k/2} = i^{qk}$, thus
 $$\chi(a) = 1 \iff \chi(g^k)=1 \iff  i^{qk} = 1 \iff 4 \mid k \iff a = b^4, b \in \F^*.$$
 $\delta_4$ is defined by  $\delta_4(a) = 1$ if $a$ is a fourth power, 0 if not. Then  
 $$-[\chi(-1)+\chi^2(-1)+\chi^3(-1)] = 1 - \delta_4(-1)4.$$
 Moreover $J(\chi,\chi)+ J(\chi^3,\chi^3) = 2 \,\mathrm{Re}\,( J (\chi,\chi))$, and
 $$J(\chi,\chi^2)+J(\chi^3,\chi^2) + J(\chi^2,\chi)+J(\chi^2,\chi^3) = 2 \,\mathrm{Re}\,(J(\chi,\chi^2) + 2\,\mathrm{Re}\,(J(\chi^2,\chi) = 4\,\mathrm{Re}\,(J(\chi,\chi^2)).$$
$\chi$ is of order 4, so $\rho = \chi^2$ is the unique character of order 2, the Legendre's character.

In conclusion,
 $$N(x^4+y^4=1) = p+1- \delta_4(-1)4+ 2 \,\mathrm{Re}\,( J (\chi,\chi))+4\,\mathrm{Re}\,(J(\chi,\rho)).$$
\end{proof}

\paragraph{Ex. 8.17}

{\it (continuation) By Exercise 8.7, $J(\chi,\chi) = \chi(-1) J(\chi,\rho)$. Let $\pi = -J(\chi,\rho)$. Show that
\begin{enumerate}
\item[(a)] $N = p-3 - 6\,\mathrm{Re}\, \pi$ if $p\equiv 1 \pmod 8$.
\item[(b)] $N = p+1 - 2 \,\mathrm{Re}\,  \pi$ if $p \equiv 5 \pmod 8$.
\end{enumerate}
}

\begin{proof}
Let $g$ a generator in  $\mathbb{F}_p^*$. As $(g^{(p-1)/2})^2=1$ and $g^{(p-1)/2} \neq 1$, then $g^{(p-1)/2} = -1$.
As in Exercise 8.16, write $\chi(g) = e^{q i\pi/2}$, with $q$ odd.

Then $-1$ is a fourth power in $\F_p^*$ iff (see Exercice 8.16)
\begin{align*}
\delta_4(-1) = 1 &\iff \chi(-1)=1\\
&\iff \chi(g^{(p-1)/2}) = 1\\
&\iff e^{q ((p-1)/2 )i\pi/2} = 1\\
&\iff  4 \mid q(p-1)/2\\
&\iff 4 \mid (p-1)/2\\
&\iff p\equiv 1 \pmod 8.
\end{align*}
By Exercise 8.7, as $\chi$ is a character of order 4,
$$J(\chi,\chi) = \chi(-1) J(\chi,\rho).$$
$\bullet$ If $p\equiv 1 [8],$

$\chi(-1) = 1$, so $J(\chi,\chi) = J(\chi,\rho)$, and $\delta_4(-1) = 1$.
\begin{align*}
N &= p+1 - \delta_4(-1) 4 + 2 \re J(\chi,\chi)  + 4 \re J(\chi,\rho)\\
&=p-3+6 \re J(\chi,\rho)\\
 &= p-3-6\re \pi,\qquad  \ \mathrm{where}\ \pi = -J(\chi,\rho).
\end{align*}
$\bullet$ If $p\equiv 5 [8],$

$\chi(-1) = -1$, donc $J(\chi,\chi) = -J(\chi,\rho)$, et $\delta_4(-1) = 0$
\begin{align*}
N &= p+1 - \delta_4(-1) 4 + 2 \re J(\chi,\chi)  + 4 \re J(\chi,\rho)\\
&= p+1 + 2 \re J(\chi,\rho)\\
 &= p+1 - 2 \re \pi.
\end{align*}
\end{proof}

\paragraph{Ex. 8.18}

{\it (continuation) Let $\pi = a+bi$. One can show (see Chapter 11, Section 5) that $a$ is odd, $b$ is even, and $a\equiv 1 \pmod 4$ if $4\mid b$ and $a\equiv -1 \pmod 4$ if $4\nmid b$. Let $p=A^2+B^2$ and fix $A$ by requiring that $A\equiv 1 \pmod 4$. Then show that
\begin{enumerate}
\item[(a)] $N = p-3 -6A$ if $p\equiv 1 \pmod 8$,
\item[(b)] $N = p+1 + 2A$ if $p \equiv 5 \pmod 8$.
\end{enumerate}
}

\begin{proof}
Recall that $\pi = -J(\chi,\rho) \in \Z[i]$, so $\pi = a + bi,\ a,b \in \Z$.
\begin{enumerate}
\item[1)] We begin by proving that $\pi \equiv 1 \pmod {2+2i}$ ( see Chapter 11, Section 5).

For all $ t \in \F_p^*$, $\rho(t) = \pm 1$, so $\rho(t) - 1 \equiv 0 \pmod 2$.

Let's verify that $\chi(t) - 1 \equiv 0 \pmod{1+i}$. $\chi(t) \in \{1,-1,i,-i\}$, so  $\chi(t) - 1 \in \{0,-2, i - 1, - i-1\}$. As $2 = (1-i)(1+i)$ and $i-1 = i(1+i)$, we obtain
$$\forall t \in \F_p^*, \ 1+i \mid \chi(t) - 1.$$
Thus
$$\forall s \in \F_p^*, \forall t \in \F_p^*, \ (\rho(s)-1)(\chi(t) - 1) \equiv 0 \pmod {2+2i}.$$
Moreover, if $s = 0, t= 1$, then $\chi(b) = 1$, and if $s=1,t=0$, then $\rho(s) = 1$, so
$$\sum_{s+t=1} (\rho(s)-1)(\chi(b)-1) \equiv 0 \pmod {2+2i}.$$
This gives, when developing this expression, :
$$-\pi - \sum_{b \in \F_p} \chi(b) - \sum_{a\in \F_p} \rho(a) + p \equiv 0 \pmod {2+2i}.$$
As $\sum_b \chi(b) = \sum_a \rho(a) = 0$, we obtain
$$\pi \equiv p \pmod {2+2i}.$$
Finally, $p \equiv 1 \pmod 4$, and $2+2i \mid 4$ since $4 = (1-i)(2+2i)$, so $p \equiv 1 \mod 2+2i$, so
$$\pi \equiv 1 \pmod {2+2i}.$$
\item[2)] By Corollary of Theorem 1, $N(\pi) = N(J(\chi,\rho) = p = a^2+b^2$.

We know that $p\equiv 1 \pmod 4$, $p = a^2 + b^2$ and $a+ib \equiv 1 \pmod {2+2i}$. Then  we prove that $a$ is odd, $b$ is even, and $a\equiv 1 \pmod 4$ if $4\mid b$ and $a\equiv -1 \pmod 4$ if $4\nmid b$. 

$a + bi \equiv 1 \pmod {2+2i}$, so $a+bi \equiv 1 \pmod 2$, so $a$ is odd, and $b$ is even.

$\bullet$ If $4 \mid b$, then $2+2i \mid b$.

$a \equiv 1 \pmod {2+2i}$, and by complex conjugation, $a\equiv 1 \pmod{2-2i}$, so $52+2i)(2-2i) = 8 \mid (a-1)^2$, thus $4 \mid a-1$.

$\bullet$ If $4 \nmid b$, then $b = 4k+2, k\in \Z$.

Therefore, $1 \equiv a+bi \equiv a +2i \pmod{2+2i}$. As $2i \equiv -2 \pmod{2+2i}$, $a\equiv 3 \equiv -1 \pmod {2+2i}$.
By conjugation, $a \equiv -1 \pmod{2-2i}$. Multiplying these congruences, we obtain $8 \mid (a+1)^2$, so $a \equiv -1 \pmod 4$.
\item[3)] $\pi = -J(\chi,\rho) = a + bi$ is such that  $a^2+b^2 = p$, $a$ odd, $b$ even and also
$$(4 \mid b \ \mathrm{and} \ a\equiv 1\ [4]) \ \mathrm{or}\ (4\nmid b\ \mathrm{and}\ a\equiv -1 \ [4]).$$
If $p = A^2+B^2$, $A$ odd and $B$ even, then also $p = (-A)^2 + B^2$, and $A \equiv 1 \pmod 4$ or $-A \equiv 1 \pmod 4$. So there exists a decomposition $p = A^2+B^2$ such that $A\equiv1 \pmod 4$. Such a decomposition is unique.
Let's verify that $4 \mid b$ if $p \equiv 1 \pmod 8, 4 \nmid b$ if $p \equiv 5 \pmod 8$.

$p = a^2 +b^2, a = 2a'+1, b = 2b'$, so $p = 4a'^2 + 4a'+1 + 4b'^2 = 8 \frac{a'(a'+1)}{2} + 1 + 4b'^2$.

Hence $4 \mid b \iff 2 \mid b' \iff 8 \mid p-1$.

Therefore if $p\equiv 1 \pmod 8$, $\re \pi = a = A$, and if $p\equiv 5 \pmod 8$, $\re \pi = a = -A$.

In conclusion, by Exercise 8.17 :

 if $p = A^2+B^2, A\equiv1 \pmod 4$, and $N =N(x^4+y^4 = 1)$ in $\F_p$,
\begin{enumerate}
\item[(a)] $N = p-3 -6A$ if $p\equiv 1 \pmod 8$,
\item[(b)] $N = p+1 + 2A$ if $p \equiv 5 \pmod 8$.
\end{enumerate}
\end{enumerate}


Note : if $p\equiv -1 \pmod 4$, then there is no character of order 4 on $\F_p^*$,  and $d = 4 \wedge (p-1) = 4 \wedge (4k+2) = 2$, so
$$N(x^4 = a) = \sum_{\chi_d = 1} \chi(a) = 1 + \rho(a) = N(x^2 = a).$$
\begin{align*}
N(x^4+y^4 = 1) &= \sum_{a+b=1} N(x^4 = a) N(y^4=b)\\
&= \sum{a+b=1} N(x^2=a) N(y^2=b)\\
&=N(x^2+y^2)=1
\end{align*}
Using Chapter 8, Section 3, we obtain
$$N(x^4+y^4=1) = p+1 \ \mathrm{if} \ p\equiv -1 \pmod 4.$$
\end{proof}

\paragraph{Ex. 8.19}

{\it Find a formula for the number of solutions to $x_1^2+x_2^2+\cdots+x_r^2 = 0$ in $\F_p$.
}

\begin{proof}
Let $\chi$ be the Legendre character. Then
\begin{align*}
N(x_1^2+x_2^2+\cdots+x_r^2=0) &= \sum\limits_{a_1+a_2+\cdots+a_r=0} N(x_1^2=a_1)N(x_2^2=a_2)\cdots N(x_r^2 = a_r)\\
&=\sum\limits_{a_1+a_2+\cdots+a_r=0} (1+\chi(a_1))(1+\chi(a_2)\cdots(1+\chi(a_r))\\
&=p^{r-1} + J_0(\chi,\chi,\cdots,\chi)
\end{align*}
(We used Proposition 8.5.1)
For all $k$, $\chi^{2k} = \varepsilon, \chi^{2k+1} = \chi$.

$\bullet$ If $r$ is odd, $\chi^r \neq \varepsilon$, so $J_0(\chi,\chi,\cdots,\chi) = 0$ (Proposition 8.5.1).
$$N(x_1^2+x_2^2+\cdots+x_r^2=0)  = p^{r-1}.$$

$\bullet$ If $r$ is even, $\chi^r = \varepsilon$, so $J_0(\chi,\chi,\cdots,\chi) = \chi(-1)(p-1)J(\chi,\chi,\cdots, \chi)$, where there are  $r-1$ components in the Jacobi sum ( Proposition 8.5.1).

By Theorem 3, $J(\chi,\chi,\cdots,\chi) g(\chi^{r-1}) = g(\chi)^{r-1}$, and  $g(\chi^{r-1}) = g(\chi)$, so
$$J(\chi,\chi,\cdots,\chi)=g(\chi)^{r-2}.$$
$g(\chi)^2 = \chi(-1) p$, therefore $\chi^{r-2} = \chi(-1)^{(r/2)-1} p^{(r/2)-1)} = (-1)^{((p-1)/2) (r/2-1)}p^{(r/2)-1)}$. So
$$N(x_1^2+x_2^2+\cdots+x_r^2=0)  = p^{r-1}+(-1)^{\frac{p-1}{2} \frac{r}{2}} (p-1)p^{\frac{r}{2}-1}.$$
(Verified in C++ with small values of $p$ and $r$.)

Conclusion :
$$
\left\{
\begin{array}{ccll}
 N(x_1^2+x_2^2+\cdots+x_r^2=0)  & =  & p^{r-1}  &\mathrm{if}\ r\ \mathrm{is}\ \mathrm{odd} \\
  &  = &   p^{r-1}+(-1)^{\frac{p-1}{2} \frac{r}{2}} (p-1)p^{\frac{r}{2}-1} &\mathrm{if}\ r\  \mathrm{is}\ \mathrm{even}.
\end{array}
\right.
$$
\end{proof}

\paragraph{Ex. 8.20}

{\it Generalize Proposition 8.6.1 by finding an explicit formula for the number of solutions to $a_1x_1^2+a_2x_2^2+\cdots+a_rx_r^2 = 1$ in $\F_p$.
}

\begin{proof}
Write $\chi$ the Legendre character.
\begin{align*}
N(a_1x_1^2+\cdots+a_r x_r^2=1)&=\sum\limits_{a_1u_1+\cdots+a_r u_r=1}N(x_1^2=u_1)\cdots N(x_r^2=u_r)\\
&=\sum\limits_{a_1u_1+\cdots+a_r u_r=1}(1+\chi(u_1)\cdots(1+\chi(u_r))  \hspace{0.5cm}(v_i = a_i u_i)\\
&=\sum\limits_{v_1+\cdots+v_r=1}(1+\chi(a_1)^{-1}\chi(v_1))\cdots(1+\chi(a_r^{-1})\chi(v_r))\\
&=p^{r-1} + \chi(a_1^{-1})\cdots\chi(a_r^{-1})J(\chi,\chi,\cdots,\chi)
\end{align*}

$\chi(a_i^{-1}) = \overline{\chi(a_i)} = \chi(a_i) = \legendre{a_i}{p}$

$J(\chi,\chi,\cdots,\chi)$ is computed in Chapter 5 Section 6. We obtain
$$
\left\{
\begin{array}{ccll}
 N(a_1x_1^2+\cdots+a_r x_r^2=1)  & =  & p^{r-1}+\legendre{a_1}{p}\cdots\legendre{a_r}{p}(-1)^{\frac{r-1}{2}\frac{p-1}{2}}p^{\frac{r-1}{2}}&\mathrm{if}\ r\ \mathrm{is}\ \mathrm{odd} \\
  &  = &p^{r-1}-\legendre{a_1}{p}\cdots\legendre{a_r}{p}(-1)^{\frac{r}{2}\frac{p-1}{2}}p^{\frac{r}{2}-1}&\mathrm{if}\ r\  \mathrm{is}\ \mathrm{even}.
\end{array}
\right.
$$
\end{proof}

\paragraph{Ex. 8.21}

{\it Suppose that $p\equiv 1 \pmod d$, $\zeta = e^{2\pi i/p}$, and consider $\sum_x \zeta^{ax^d}$. Show that $\sum_x \zeta^{ax^d} = \sum_r m(r)\zeta^{ar}$, where $m(r) = N(x^d = r)$.
}

\begin{proof}
Let $A_r = \{x \in \mathbb{F}_p \ \vert \ x^d=r\}$

Then  $\mathbb{F}_p = \coprod_r A_r$, thus

$$\sum\limits_{x\in \mathbb{F}_p} \zeta^{ax^d} = \sum\limits_{r \in \mathbb{F}_p} \sum\limits_{x \in A_r} \zeta^{a x^d} = \sum\limits_{r \in \mathbb{F}_p} \vert A_r\vert \zeta^{ar}= \sum\limits_{r \in \mathbb{F}_p} m(r)\zeta^{ar},$$

where $m(r) = \vert A_r\vert = N(x^d=r)$
\end{proof}

\paragraph{Ex. 8.22} 
{\it  (continuation) Prove that $\sum_x \zeta^{ax^d} = \sum_\chi g_a(\chi)$, where the sum is over all $\chi$ such that $\chi^d=\varepsilon, \chi \ne \varepsilon$. Assum that $p \nmid a$.
}

\begin{proof}
By Exercise 8.21,
$$S = \sum_{x \in \F_p} \zeta^{ax^d} = \sum_{ r \in \F_p} m(r) \zeta^{ar}.$$

As  $d \mid p-1$, by Proposition 8.1.5,
$$m(r) = N(x^d=r) = \sum_{\chi^d = \varepsilon} \chi(r).$$

Therefore
 $$S = \sum_{r\in \F_p}\, \sum_{\chi^d = \varepsilon} \chi(r) \zeta^{ar} =\sum_{\chi^d = \varepsilon} \sum_{r\in \F_p} \chi(r) \zeta^{ar}.$$

If $\chi = \varepsilon, \sum\limits_{r\in \F_p} \chi(r) \zeta^{ar} = \sum\limits_{r\in \F_p} \zeta^{ar} = 0$, since $a\not \equiv 0 \pmod p$.

By definition $g_a(\chi) =  \sum_r \chi(r) \zeta^{ar}$, so, if $d \mid p-1$, $p \nmid a$,

$$\sum_{x\in \mathbb{F}_p} \zeta^{a x^d} = \sum_{\chi^d=\varepsilon,\, \chi\neq \varepsilon} g_a(\chi)$$
\end{proof}

\paragraph{Ex. 8.23}

{\it Let $f(x_1,x_2,\ldots,x_n) \in \F_p[x_1,x_2,\ldots,x_n]$. Let $N$ be the number of zeros of $f$ in $\F_p$. Show that $N = p^{n-1} + p^{-1} \sum_{a\neq 0} (\sum_{x_1,\ldots,x_n } \zeta^{af(x_1,\ldots,x_n)})$.
}

\begin{proof}
Let $A_r= \{(x_1,x_2,\cdots,x_n)\in\mathbb{F}_p^n \ \vert \ f(x_1,x_2,\cdots,x_n)=r\}$. Then $\mathbb{F}_p^n = \coprod\limits_{r\in\mathbb{F}_p} A_r$, so, for all $a \in \mathbb{F}_p$,
\begin{align*}
\sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)} 
&=\sum\limits_{r\in \mathbb{F}_p} \sum\limits_{(x_1,x_2,\cdots,x_n) \in A_r}  \zeta^{ar}\\
&=\sum\limits_{r\in \mathbb{F}_p} \vert A_r\vert \zeta^{ar}\\
\end{align*}
Let $m(r) = \vert A_r\vert = N(f(x_1,x_2,\cdots,x_n)=r)$. Then
\begin{align*}
\sum\limits_{a\in \mathbb{F}_p} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)} &=\sum\limits_{a\in \mathbb{F}_p}\sum\limits_{r\in \mathbb{F}_p} m(r) \zeta^{ar}\\
&=\sum\limits_{r\in \mathbb{F}_p} m(r) \sum\limits_{a\in \mathbb{F}_p} \zeta^{ar}
\end{align*}
As $\sum\limits_{a\in \mathbb{F}_p} \zeta^{ar}=0$ if $r\neq 0$, and $\sum\limits_{a\in \mathbb{F}_p} \zeta^{ar} = p$ if $r=0$, we obtain
$$\sum\limits_{a\in \mathbb{F}_p} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)} = m(0) p = p N.$$

Moreover
$$\sum\limits_{a\in \mathbb{F}_p} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)} = p^n + \sum\limits_{a\in \mathbb{F}_p^*} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)},$$

so $$pN = p^n +\sum\limits_{a\in \mathbb{F}_p^*} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)}.$$  In conclusion,

$$N = p^{n-1}+p^{-1} \sum\limits_{a\in \mathbb{F}_p^*} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{af(x_1,x_2,\cdots,x_n)}.$$
\end{proof}

\paragraph{Ex. 8.24}

{\it (continuation) Let $f(x_1,x_2,\ldots,x_n) = a_1x_1^{m_1}+a_2x_2^{m_2}+\cdots+a_n x_n^{m_n}$. Let $d_i = (m_i,p-1)$. Show that $N = p^{n-1} + p^{-1} \sum_{a\neq 0} \prod_{i=1}^n \sum_{\chi_i} g_{aa_i}(\chi_i)$ where $\chi_i$ runs over all characters such that $\chi_i^{d_i} = \varepsilon$ and $\chi_i \neq \varepsilon$.
}

\begin{proof}
By Exercise 8.2, $$N = N(a_1 x_1^{m_1}+\cdots a_n x_n^{m_n} = 0) = N(a_1 x_1^{d_1}+\cdots a_n x_n^{d_n} = 0),$$where $d_i = m_i \wedge (p-1)$ divides $p-1$.

By Exercise 8.23, 
$$N = p^{n-1}+p^{-1} \sum\limits_{a\in \mathbb{F}_p^*} \sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{a(a_1 x_1^{d_1}+\cdots a_n x_n^{d_n} )}$$

By Exercise 8.22, since $p \nmid a, p\nmid a_i$,
\begin{align*}
\sum\limits_{(x_1,x_2,\cdots,x_n) \in \mathbb{F}_p^n} \zeta^{a(a_1 x_1^{d_1}+\cdots a_n x_n^{d_n} )} &=\left( \sum\limits_{x_1 \in \mathbb{F}_p} \zeta^{aa_1 x_1^{d_1}}\right)\cdots\left(\sum\limits_{x_1 \in \mathbb{F}_p} \zeta^{aa_n x_n^{d_n}}\right)\\
&=\left(\sum\limits_{\chi_1^{d_1} = \varepsilon,\, \chi_1\neq \varepsilon} g_{aa_1}(\chi_1)\right)\cdots\left(\sum\limits_{\chi_n^{d_n}= \varepsilon,\,\chi_n \neq \varepsilon} g_{aa_n}(\chi_n)\right)\\
&=\prod\limits_{i=1}^n \sum\limits_{\chi_i^{d_i}= \varepsilon,\, \chi_i \neq \varepsilon} g_{aa_i}(\chi_i)
\end{align*}
In conclusion,

$$N = p^{n-1}+p^{-1} \sum\limits_{a\in \mathbb{F}_p^*}  \prod\limits_{i=1}^n \sum\limits_{\chi_i^{d_i} = \varepsilon,\chi_i \neq \varepsilon} g_{aa_i}(\chi_i)$$
\end{proof}

\paragraph{Ex. 8.25}

{\it Deduce from Exercise 8.24 that $|N-p^{n-1}| \leq (p-1)(d_1-1)\cdots(d_n-1)p^{(n/2)-1}$.
}

\begin{proof}
As $\vert g_{aa_i}(\chi_i)  \vert= \sqrt{p}$,

$$\left\vert\sum\limits_{\chi_i^{d_i} = \varepsilon,\,\chi_i \neq \varepsilon} g_{aa_i}(\chi_i)\right\vert \leq \sqrt{p} \ n_i,$$ where $n_i = \mathrm{Card}\,\{\chi_i \neq \varepsilon \ \vert\  \chi_i^{d_i} = \varepsilon \}$.

As $d_i \mid p-1$, there exists exactly $d_i$ characters of order dividing $d_i$, so $n_i = d_i-1$ :

$$\left | \sum\limits_{\chi_i^{d_i} = \varepsilon,\,\chi_i \neq \varepsilon} g_{aa_i}(\chi_i)\right | \leq \sqrt{p} (d_i-1).$$

By Exercise 8.24,
 $$N = p^{n-1}+p^{-1} \sum\limits_{a\in \mathbb{F}_p^*}  \prod\limits_{i=1}^n \sum\limits_{\chi_i^{d_i} = \varepsilon,\chi_i \neq \varepsilon} g_{aa_i}(\chi_i)$$
 
so $$\vert N - p^{n-1}\vert  \leq p^{-1} (p-1) \sqrt{p}(d_1-1)\cdots \sqrt{p}(d_n-1),$$ that is
 
$$\vert N - p^{n-1}\vert  \leq (p-1)(d_1-1)\cdots(d_n-1) p^{\frac{n}{2}-1}$$
\end{proof}

\paragraph{Ex. 8.26}

{\it  Let $p$ be a prime, $p \equiv 1 \pmod 4$, $\chi$ a multiplicative character of order $4$ on $\F_p$, and $\rho$ the Legendre symbol. Put $J(\chi,\rho) = a + bi$. Show
\begin{enumerate}
\item[(a)] $N(y^2+x^4 = 1) = p-1 + 2a$.
\item[(b)] $N(y^2 = 1 -x^4) = p + \sum\rho(1-x^4)$.
\item[(c)] $ 2a \equiv -(-1)^{(p-1)/4} \binom{2m}{m}   \pmod p$ where $m = (p-1)/4$.
\item[(d)] Verify (c) for $p=13,17,29$.
\end{enumerate}
}

\begin{proof}
\begin{enumerate}
\item[(a)] By Proposition 8.1.5,
\begin{align*}
N(y^2+x^4=1) &=\sum\limits_{a+b=1} N(y^2=a)N(x^4=b)\\
&=\sum\limits_{a+b=1}(1+\rho(a))(1+\chi(b)+\chi^2(b)+\chi^3(b))\\
&=\sum\limits_{i=0}^1 \sum\limits_{j=0}^3\sum\limits_{a+b=1}\rho^i(a) \chi^j(b)\\
&=\sum\limits_{i=0}^1 \sum\limits_{j=0}^3 J(\rho^i, \chi^j)
\end{align*}

As $J(\varepsilon,\varepsilon)=p$, and $0 = J(\varepsilon,\chi) = J(\varepsilon,\chi^2)=J(\varepsilon,\chi^3) = J(\rho,\varepsilon)$, we obtain

$$N(y^2+x^4=1)  = p + J(\rho,\chi)+J(\rho,\chi^2)+J(\rho,\chi^3).$$

As $J(\rho,\chi^3)=J(\bar{\rho},\bar{\chi}) = \overline{J(\rho,\chi)}$,
and
$J(\rho,\chi^2) = J(\rho,\rho) = J(\rho,\rho^{-1}) = -\rho(-1) = -(-1)^{(p-1)/2} = -1$ (since $p\equiv 1 \pmod 4$).
Moreover, by Exercise 8.7,
$$J(\chi,\rho) = \chi(-1) J(\chi,\chi) = \pm J(\chi,\chi) \in \mathbb{Z}[i] : J(\chi, \rho) = a+bi, (a,b) \in \mathbb{Z}^2.$$

Thus $N(y^2+x^4 = 1) = p + 2\re J(\chi,\rho) + J(\rho,\rho) = p-1+2a$

In conclusion, 
$$N(y^2+x^4 = 1) = p-1+2a,  \ \mathrm{where}\  J(\chi,\rho) = a+bi.$$

\item[(b)]  By Exercise 8.8, 
\begin{align*}
\sum\limits_{t \in \mathbb{F}_p} \rho(1-t^4) &= \sum\limits_{\lambda^4 = \varepsilon} J(\rho,\lambda)\\
&=J(\rho,\varepsilon) + J(\rho,\chi)+ J(\rho,\chi^2)+ J(\rho,\chi^3)\\
&=J(\rho,\rho)+ J(\rho,\chi)+J(\rho,\bar{\chi})\\
&=-1 + 2 \re J(\chi,\rho)\\
&=-1+2a
\end{align*}

So $N(y^2=1-x^4) = p-1+2a = p+\sum\limits_{t\in \mathbb{F}_p} \rho(1-t^4)$


\item[(c)]  Reducing modulo $p$, we obtain :
\begin{align*}
2\,\overline{a}  &= 1 + \sum\limits_{t\in \mathbb{F}_p} \rho(1-t^4)\\
&= 1 + \sum\limits_{t\in \mathbb{F}_p}(1-t^4)^{\frac{p-1}{2}}\\
&=1 + \sum\limits_{t\in \mathbb{F}_p} \sum\limits_{k=0}^{(p-1)/2} \binom{\frac{p-1}{2}}{k} (-1)^k t^{4k}\\
&= 1 + \sum\limits_{k=0}^{(p-1)/2}(-1)^k \binom{\frac{p-1}{2}}{k}\sum_{t\in \mathbb{F}_p}  t^{4k}\\
&= 1 + \sum\limits_{k=1}^{(p-1)/2}(-1)^k \binom{\frac{p-1}{2}}{k}\sum\limits_{t\in \mathbb{F}_p^*}   t^{4k} 
\end{align*}

Let $S_k = \sum\limits_{t\in \F_p^*}  t^{4k} ,\  k>0 $, and $g$ a generator of $\F_p^*$ : $t = g^i, 0 \leq i \leq p-2$.

$$S_k = \sum\limits_{i=0}^{p-2} (g^{i})^{4k}=\sum\limits_{i=0}^{p-2} (g^{4k})^i.$$

If $g^{4k} \ne 1$, $S_k \equiv \frac{g^{4k(p-1)}-1}{g^{4k}-1} = 0$, if not $S_k = p-1 = -1$.


For every $k$, $1\leq k \leq (p-1)/2$,
$$g^{4k} = 1\iff p-1 \mid 4k \iff \frac{p-1}{4} \mid k \iff k=\frac{p-1}{4} \ \mathrm{or}\  k=\frac{p-1}{2},$$ therefore

$$2a \equiv 1 - (-1)^{\frac{p-1}{4}}\binom{\frac{p-1}{2}}{\frac{p-1}{4}} - (-1)^{\frac{p-1}{2}}\binom{\frac{p-1}{2}}{\frac{p-1}{2}}\pmod p,$$

$$2a \equiv - (-1)^{\frac{p-1}{4}}\binom{\frac{p-1}{2}}{\frac{p-1}{4}}\ \pmod p$$


\item[(d)] 

 $\bullet$ If $p=13$, I choose the primitive root $g = \overline{2}$, and $\chi$ the character of order 4 defined by $\chi(g) = i$ (the only other character of order 4 is $\overline{\chi}$).
 
Then $J(\chi,\rho) = -3+2i, a = -3$.

$$N=p-1+2a=6.$$

$2a=-6, -(-1)^{\frac{13-1}{4}} \binom{6}{3} = 20$ et $-6\equiv20\pmod {13}$.

$\bullet$ If $p=17$, $g = 3$,  $\chi(g) = i$, $J(\chi,\rho) = -1+4i, a=-1$.

$$N = p-1+2a = 14.$$

$2a=-2, -(-1)^{\frac{17-1}{4}} \binom{8}{4} =-70 \equiv -2\pmod{17}$.

$\bullet$ Si $p=29$, $g = 3$,  $\chi(g) = i$, $J(\chi,\rho) = 5+2i, a=5$.

$$N = p-1+2a = 38.$$

$2a=10, -(-1)^{\frac{29-1}{4}} \binom{14}{7} =3432 \equiv 10\pmod {29}$ ($3422 = 118\times 29$).

\end{enumerate}
\end{proof}

Note : By Prop. 8.3.1 (and Ex. 8.7),  $ p = | J(\chi,\rho) |^2 = |J(\chi,\chi)|$, so $a^2 + b^2 = p$ (where $p = 4m+1$).

As $\binom{2m}{m} = 2 \binom{2m-1}{m-1}$ is even, and as $p$ is an odd prime $a \equiv \pm \frac{1}{2} \binom{2m}{m} \pmod p$.

Since $p\geq 5$, $p = a^2+b^2$ implies $|a| < \sqrt{p} < p/2$, thus the least remainder of $\frac{1}{2} \binom{2m}{m}$ is $\pm a$. 

Moreover, from Wilson theorem, we obtain a square root of $-1$ in $\F_p$ ($p = 4 m +1$) :
$$-1 \equiv (p-1)! \equiv \left[ (-1)^{(p-1)/4} \left( \frac{p-1}{2}\right)!\right]^2 = [(2m)!]^2.$$
Since $\overline{b}\overline{a}^{-1} = -\overline{1}$ in $\F_p$, we obtain $ b \equiv (2m)! a \pmod p$. The conclusion is the proposition of Gauss, which  gives an explicit formula for the solution of $p=a^2+b^2$ :

{\bf Proposition} {\it Let $p$ a prime of the form $p=4m+1$.

If 
\begin{align*}
a &\equiv \frac{1}{2} \binom{2m}{m} \pmod p,\qquad -\frac{p}{2} < a < \frac{p}{2},\\
b &\equiv (2m)!\, a\ \pmod p,\qquad  -\frac{p}{2} < b < \frac{p}{2},
\end{align*}
then $p = a^2+b^2$.
}

\paragraph{Ex. 8.27}

{\it Let $p\equiv 1 \pmod 3$, $\chi$ a character of order 3, $\rho$ the Legendre symbol. Show
\begin{enumerate}
\item[(a)] $N(y^2 = 1 - x^3) = p + \sum \rho(1-x^3)$.
\item[(b)] $N(y^2 + x^3 = 1) = p + 2 \re J(\chi,\rho)$.
\item[(c)] $2a-b \equiv - \binom{(p-1)/2}{(p-1)/3} \pmod p$ where $J(\chi,\rho) = a + b \omega$.
\end{enumerate}
}

\begin{proof} 


\begin{enumerate} 

\item[(b)] By Exercise 8.15,

$$N(y^2=x^3+D) = p + 2 \re(\pi), \ \mathrm{where}\ \pi =(\rho \chi)(D) J(\chi,\rho).$$

Moreover, with $D = 1$, we obtain
\begin{align*}
N(y^2+x^3=1) &= N(y^2+(-x)^3=1) \\
 &= p+  2 \re J(\chi,\rho).
\end{align*}

$J(\chi,\rho) = \sum\limits_{a+b=1} \chi(a) \rho(b)$, where $\rho(b)\in \{-1,1\}, \chi(a) \in \{1,\omega,\omega^2\}$, so $J(\chi,\rho) \in \mathbb{Z}[\omega]$.

$J(\chi,\rho) = a + b\omega, a\in \mathbb{Z}, b \in \mathbb{Z}$ and $2 \re(J(\chi,\rho)) = 2a-b$.

\item[(a)] By Exercise 8.8,
\begin{align*}
\sum\limits_x\rho(1-x^3) &= \sum\limits_{\lambda^3=\varepsilon} J(\rho,\lambda)\\
&=J(\rho,\varepsilon) + J(\rho,\chi) + J(\rho,\chi^2)\\
&= 2 \re J(\chi,\rho)
\end{align*}
so
\begin{align*}
N(y^2=1-x^3) &= p + \sum_x \rho(1-x^3)\\
&= p+2a-b
\end{align*}


\item[(c)]Reducing modulo $p$, we obtain  in $\F_p$ :
\begin{align*}
2\overline{a}  -\overline {b} &= \sum\limits_{x} \rho(1-x^3)\\
&=  \sum\limits_{t \in \F_p} (1-t^3)^{\frac{p-1}{2}}\\
&= \sum\limits_{t \in \F_p} \sum\limits_{k=0}^{(p-1)/2} \binom{\frac{p-1}{2}}{k} (-1)^k t^{3k}\\
&=  \sum\limits_{k=0}^{(p-1)/2}(-1)^k \binom{\frac{p-1}{2}}{k}\sum\limits_{t \in \F_p}   t^{3k}\\
&= \sum\limits_{k=1}^{(p-1)/2}(-1)^k \binom{\frac{p-1}{2}}{k}\sum\limits_{t \in \F_p}   t^{3k} \pmod p
\end{align*}

Let $S_k = \sum\limits_{t \in \F_p}   t^{3k} \ (0<k\leq\frac{p-1}{2}) $, and $g$ a primitive root in $\F_p$ : $t = g^i, 0 \leq i \leq p-2$.

$S_k = \sum\limits_{i=0}^{p-2} (g^{i})^{3k}=\sum\limits_{i=0}^{p-2} (g^{3k})^i$

If $g^{3k} \ne 1 , S_k = \frac{g^{3k(p-1)}-1}{g^{3k}-1} = 0$, if not $S_k = p-1 = -1$.

$$g^{3k} = 1 \iff p-1 \mid 3k \iff \frac{p-1}{3} \mid k \iff k=\frac{p-1}{3}$$ and $\frac{p-1}{3}$ even, so

$$2a-b \equiv -\binom{\frac{p-1}{2}}{\frac{p-1}{3}}\pmod p \ \ (\mathrm{with}\ J(\chi,\rho) = a+b \omega)$$
\end{enumerate}
\end{proof}

\paragraph{Ex. 8.28}

{\it Let $p\equiv 3 \pmod 4$ and $\chi$ the quadratic character defined on $\Z/p\Z$. Show
\begin{enumerate}
\item[(a)] $\sum_{x=1}^{p-1} x\chi(x) = 2 \sum_{x=1}^{(p-1)/2} x\chi(x) - p \sum_{x=1}^{(p-1)/2} \chi(x)$.
\item[(b)] $\sum_{x=1}^{p-1} x\chi(x) =  4 \chi(2)\sum_{x=1}^{(p-1)/2} x \chi(x) - p \chi(2) \sum_{x=1}^{(p-1)/2}\chi(x)$.
\item[(c)] If $p\equiv 3 \pmod 8$ then $\sum_{x=1}^{p-1} x\chi(x)/p =- \frac{1}{3} \sum_{x=1}^{(p-1)/2} \chi(x)$.
\item[(d)] If $p \equiv 7 \pmod 8$ then $\sum_{x=1}^{p-1} x\chi(x)/p =- \sum_{x=1}^{(p-1)/2} \chi(x)$.
\end{enumerate}
}
Note : I added two minus signs in (c) and (d) to write a true sentence. See the verification below.
\begin{proof}
\begin{enumerate}
\item[(a)]  $\chi(-1) = (-1)^{(p-1)/2}=-1$, thus
\begin{align*}
\sum_{x=1}^{p-1} x \chi(x) &= \sum_{x=1}^{(p-1)/2} x \chi(x)+ \sum_{x=(p-1)/2+1}^{p-1} x \chi(x)\\
&=\sum_{x=1}^{(p-1)/2} x \chi(x) + \sum_{y=1}^{(p-1)/2} (p-y) \chi(p-y)\qquad (x = p-y)\\
&=\sum_{x=1}^{(p-1)/2} x \chi(x) -\left [ p\sum_{x=1}^{(p-1)/2}  \chi(x) - \sum_{x=1}^{(p-1)/2} x \chi(x)\right ]\\
&= 2 \sum_{x=1}^{(p-1)/2} x \chi(x) - p \sum_{x=1}^{(p-1)/2}  \chi(x)
\end{align*}


\item[(b)] If we separate even and odd indices, we obtain, as $p$ is odd :
\begin{align*}
\sum_{x=1}^{p-1} x \chi(x)  &=\sum_{k=1}^{(p-1)/2} 2k \chi(2k) + \sum_{k=0}^{(p-1)/2 - 1} (2k+1) \chi(2k+1)\\
&= \sum_{x=1}^{(p-1)/2} 2x \chi(2x)+\sum_{x=1}^{(p-1)/2}(p-2x) \chi(p-2x))\qquad (2k+1 = p - 2x) \\
&=2 \chi(2)\sum_{x=1}^{(p-1)/2} x \chi(x) - \chi(2) \sum_{x=1}^{(p-1)/2} (p-2x) \chi(x)\\
&=4 \chi(2) \sum_{x=1}^{(p-1)/2} x \chi(x) - p\chi(2) \sum_{x=1}^{(p-1)/2}  \chi(x)
\end{align*}

\item[(c)] Let $S= \sum\limits_{x=1}^{(p-1)/2}  \chi(x), T = \sum\limits_{x=1}^{(p-1)/2} x \chi(x)$. Then
\begin{align*}
(a) \sum_{x=1}^{p-1} x \chi(x) &= 2 T - p S\\
(b) \sum_{x=1}^{p-1} x \chi(x) &= 4 \chi(2) T - p \chi(2) S
\end{align*}

Subtracting theses equalities , we obtain

\begin{align*}
(4\chi(2)-2 )T &= p(\chi(2) - 1) S \\
\frac{T}{p} &= \frac{\chi(2) - 1}{4\chi(2) - 2} S
\end{align*}

$\chi(2) = (-1)^{(p^2-1)/8} = -1 $ if $p\equiv 3\pmod 8$, so  $\frac{\chi(2) - 1}{4\chi(2) - 2} = \frac{1}{3}$, and $T/p = (1/3) S$.
$$\sum_{x=1}^{ p-1} x \chi(x) /p = 2T/p - S =  -(1/3)S,$$
$$\sum_{x=1}^{ p-1} x \chi(x) /p = -\frac{1}{3} \sum\limits_{x=1}^{(p-1)/2}  \chi(x).$$

\item[(d)] 
$\chi(2) = (-1)^{(p^2-1)/8}  = 1$ if $p\equiv 7\pmod 8$ : $\frac{\chi(2) - 1}{4\chi(2) - 2} = 0$.
$$\sum_{x=1}^{p-1} x \chi(x) /p = - \sum_{x=1}^{(p-1)/2}  \chi(x).$$
Verification : with $p=7$, the squares are $1,4,2=9$, so
\begin{align*}
\sum_{x=1}^{p-1} x \chi(x) /p  &= \frac{1}{7} \left[ \legendre{1}{7} + 2 \legendre{2}{7} + 3 \legendre{3}{7} + 4 \legendre{4}{7} + 5 \legendre{5}{7} + 6 \legendre{6}{7} \right]\\
&= \frac{1}{7} \left( 1 + 2 -3+4-5-6\right) = -1\\
\sum_{x=1}^{(p-1)/2}  \chi(x)&=\legendre{1}{7} + \legendre{2}{7} + \legendre{3}{7}\\
&= 1 + 1 - 1 = 1.
\end{align*}
With $p = 3$,
\begin{align*}
\sum_{x=1}^{p-1} x \chi(x) /p  &= \frac{1}{3} \left[ \legendre{1}{3} + 2 \legendre{2}{3} \right]\\
&= \frac{1}{3} \left( 1  - 2 \right)= -\frac{1}{3}\\
\sum_{x=1}^{(p-1)/2}  \chi(x)&=\legendre{1}{3}\\
&= 1 
\end{align*}
This confirms the misprints  in the initial sentence.
\end{enumerate}
\end{proof}


{ \Large \bf Chapter 9} 

\paragraph{Ex. 9.1}

{\it If $\alpha \in \Z[\omega]$, show that $\alpha$ is congruent to either $0,1$, or $-1$ modulo $1-\omega$.
}

\begin{proof}
Let $\lambda = 1 - \omega$, and $z = a+b\omega \in D = \Z[\omega], a,b \in \Z$.

$\omega \equiv 1 \pmod \lambda$, so $z \equiv a+b \pmod \lambda$, with $c = a+b \in \Z$.

$c\equiv 0,1,-1 \pmod 3$, and since $\lambda \mid 3$, $\lambda \equiv 0,1,-1 \pmod \lambda$.

Conclusion : every $z \in D$ is congruent to either $0,1$, or $-1$ modulo $\lambda = 1 -\omega$.

Note :  $1\not \equiv -1 \pmod \lambda$, if not $\lambda \mid 2$, so $2 = \lambda \lambda'$, $N(2) = N(\lambda) N(\lambda')$, thus $4 = 3 N(\lambda')$, so $3 \mid 4$ : this is absurd.

$\pm1 \equiv 0 \pmod \lambda$ implies $\lambda \mid 1$, so $\lambda$ would be an unit, in contradiction with $\lambda$ prime.

So there exist exactly three classes modulo $\lambda$ in $D$ : $ | D/\lambda D | = 3 = N(\lambda)$.

\end{proof}

\paragraph{Ex. 9.2}

{\it From now on we shall set $D = \Z[\omega]$ and $\lambda = 1 - \omega$. For $\mu$ in $D$ show that we can write $\mu = (-1)^a \omega^b \lambda^c\pi_1^{a_1}\pi_2^{a_2}\cdots\pi_t^{a_t}$, where $a,b,c$, and the $a_i$ are nonnegative integers and the $\pi_i$ are primary primes.
}

\begin{proof}
Let $S$ the set containing $\lambda = 1 - \omega$ and all primary primes. By Proposition 9.3.5,
\begin{enumerate}
\item[(a)] Every prime in $D$ is associate to a prime in $S$.
\item[(b)] No two primes in $S$ are associate.
\end{enumerate}
By Theorem 3, Chapter 1, as $D = \Z[\omega]$ is a principal ideal domain,  every $\mu \in D$ is of the form
$$\mu = u \prod_{\lambda \in S} \lambda^{e(\lambda)},$$
where $u$ is a unit, so $u = (-1)^a\omega^b$. Thus
$$\mu = (-1)^a \omega^b \lambda^c\pi_1^{a_1}\pi_2^{a_2}\cdots\pi_t^{a_t},$$ where the $\pi$ are primary primes, and $a,b,c$ and the $a_i$ are nonnegative integers.
\end{proof}

\paragraph{Ex. 9.3}

{\it Let $\gamma$ a primary prime. To evaluate $\chi_\gamma(\mu)$ we see, by Exercise 2, that it is enough to evaluate $\chi_\gamma(-1), \chi_\gamma(\omega), \chi_\gamma(\lambda)$, and $\chi_\gamma(\pi)$, where $\pi$ is a primary prime. Since $-1 =(-1)^3$ we have $chi_\gamma(-1) = 1$. We now consider $\chi_\gamma(\omega)$. Let $\gamma = a+b \omega$ and set $a = 3m -1$ and $b=3n$. Show that $\chi_\gamma(\omega) = \omega^{m+n}$.
}

\begin{proof}
Let $\gamma = a+b\omega=3m-1+3n\omega$. Then  $\chi_{\gamma}(\omega) = \omega^{\frac{N(\gamma)-1}{3}}$.
\begin{align*}
N(\gamma)-1 &= (3m-1)^2+(3n)^2-3n(3m-1)-1\\
&=9m^2 - 6m + 9n^2 -9nm + 3n\\
\frac{N(\gamma)-1}{3}&= 3m^2-2m+3n^2-3nm+n \equiv n+m \ [3]
\end{align*}
Thus, for $\gamma = a+b\omega=3m-1+3n\omega$,

$$\chi_{\gamma}(\omega) = \omega^{\frac{N(\gamma)-1}{3}} = \omega^{n+m}$$
\end{proof}

\paragraph{Ex. 9.4}

{\it (continuation) Show that $\chi_\gamma(\omega) = 1,\omega$, or $\omega^2$ according to whether $\gamma$ is congruent to 8,2, or 5 modulo $3\lambda$. In particular, if $q$ is a rational prime, $q \equiv 2 \pmod 3$, then $\chi_q(\omega) = 1, \omega$, or $\omega^2$ according to whether $q \equiv 8,2$, or $5,\pmod 9$. [Hint : $\gamma = a + b \omega = -1 + 3(m+n\omega)$, and so $\gamma \equiv -1 + 3(m+n) \pmod{3\lambda}$.]
}

\begin{proof}
$\lambda=1-\omega$, so $\omega\equiv1\ \pmod \lambda$. Thus
\begin{align*}
m+n\omega &\equiv m+n\ \pmod \lambda\\
3(m+n \omega) &\equiv 3 (m+n) \pmod{3\lambda}\\
\gamma = -1 + 3(m+n\omega) &\equiv -1+3(m+n) \pmod{3 \lambda}
\end{align*}
Moreover $9 = 3 \lambda \bar{\lambda} \equiv 0 \pmod{3 \lambda}$, thus $\gamma$ is congruent modulo $3\lambda$ to an integer between  $0$ and $8$ of the form $3k-1$ : $\gamma \equiv 8,2$ or $5 \pmod{3\lambda}$.

By Ex. 9.3, $\chi_\gamma(\omega) = 1 \iff m+n \equiv 0 \ [3]$, and $m+n  \equiv 0 \ [3]$ implies $m+n = 3k, k \in \Z$, so $\gamma  \equiv -1+ 9k \equiv -1 \equiv 8 \ [3\lambda]$.

Reciprocally, if $\gamma \equiv 8 \equiv -1 \ [3\lambda]$, then $3\lambda \mid 3(m+n)$, so $\lambda \mid m+n$, and $N(\lambda) \mid N(m+n)$, $3 \mid (m+n)^2$, thus $3 \mid m+n$,  $m+n \equiv 0 \ [3]$, and so $\chi_\gamma(\omega) = 1$. As the two other cases are similar, we obtain

\begin{align*}
\chi_\gamma(\omega) = 1 &\iff m+n \equiv 0\ [3] \iff \gamma \equiv 8 \ [3\lambda]\\
\chi_\gamma(\omega) = \omega &\iff m+n \equiv 1\ [3] \iff \gamma \equiv 2 \ [3\lambda]\\
\chi_\gamma(\omega) = \omega^2 &\iff m+n \equiv 2\ [3] \iff \gamma \equiv 5 \ [3\lambda]
\end{align*}

If $\gamma = q$ is a rational prime,
$q \equiv 8 \ [9]$ implies $q \equiv 8\ [3\lambda]$, since $3 \lambda \mid 9 = 3 \lambda \bar{\lambda}$, thus $\chi_q(\omega) = 1$.

Reciprocally, if $\chi_q(\omega) = 1$, then $q \equiv 8\ [3\lambda]$, $q-8 = \mu (3 \lambda), \mu \in D$, therefore 

$(q-8)^2 = N(\mu) 3^3, 3^3 \mid (q-8)^2$, thus $3^2 \mid q-8$ and so $q \equiv 8 \ [9]$. The two other cases are similar.

\begin{align*}
\chi_q(\omega) = 1 & \iff q \equiv 8 \ [9]\\
\chi_q(\omega) = \omega & \iff q \equiv 2 \ [9]\\
\chi_q(\omega) = \omega^2 &\iff q \equiv 5 \ [9]
\end{align*}
\end{proof}

\paragraph{Ex. 9.5}
{\it In the text we stated Eisenstein's result $\chi_\gamma(\lambda) = \omega^{2m}$. Show that $\chi_{\gamma}(3) = \omega^{2n}$.
}

\begin{proof}
$(1-\omega)^2 = -3 \omega$, thus $\chi_\gamma((1-\omega)^2) = \chi_\gamma(-1)\chi_\gamma(3)\chi_\gamma(\omega)$.

$\chi_\gamma((1-\omega)^2)= \chi_\gamma(\lambda^2) = \omega^{4m} = \omega^m$

As $-1 = (-1)^3, \chi_\gamma(-1) = 1$. Finally  $\chi_\gamma(\omega) = \omega^{m+n}$ by Exercise 9.3. Thus

$$\omega^m = \chi_\gamma(3) \omega^{m+n},\qquad  \chi_\gamma(3) = \omega^{-n} = \omega^{2n}.$$

Conclusion : 
$$\chi_\gamma(3) = \omega^{2n}$$
\end{proof}

\paragraph{Ex. 9.6}

{\it Prove that
\begin{enumerate}
\item[(a)] $\chi_\gamma(\lambda) = 1$ for $\gamma \equiv 8, 8 + 3\omega, 8 + 6 \omega \ [9]$.
\item[(b)] $\chi_\gamma(\lambda) = \omega$ for $\gamma \equiv 5, 5 + 3\omega, 5 + 6 \omega \ [9]$.
\item[(c)]$\chi_\gamma(\lambda) = \omega^2$ for $\gamma \equiv 2, 2 + 3\omega, 2 + 6 \omega \ [9]$.
\end{enumerate}
}

\begin{proof}
$\gamma = -1 + 3(m+n\omega)$, et $\chi_\gamma(\lambda) = \omega^{2m}$.
\begin{align*}
\chi_\gamma(\lambda)=1 &\iff m\equiv0\ [3] \Rightarrow \gamma \equiv 8+3n\omega\ [9]\Rightarrow \gamma\equiv8,8+3\omega,8+6\omega\ [9]\\
\chi_\gamma(\lambda)=\omega&\iff m\equiv2\ [3] \Rightarrow \gamma \equiv5+3n\omega\ [9]\Rightarrow \gamma\equiv5,5+3\omega,5+6\omega\ [9]\\
\chi_\gamma(\lambda)=\omega^2& \iff m\equiv1\ [3] \Rightarrow \gamma \equiv2+3n\omega\ [9]\Rightarrow \gamma\equiv2,2+3\omega,2+6\omega\ [9]\\
\end{align*}

As $\chi_\gamma(\lambda) \in \{1,\omega,\omega^2\}$, these 9 cases are the only possibilities. Moreover these 9 cases are mutually exclusive, since $9$ doesn't divide  any difference. Thus the reciprocals are true.
\begin{align*}
\chi_\gamma(\lambda)=1 &\iff \gamma\equiv8,8+3\omega,8+6\omega\ [9]\\
\chi_\gamma(\lambda)=\omega&\iff \gamma\equiv5,5+3\omega,5+6\omega\ [9]\\
\chi_\gamma(\lambda)=\omega^2&\iff \gamma\equiv2,2+3\omega,2+6\omega\ [9]\\
\end{align*}
\end{proof}

\paragraph{Ex. 9.7}

{\it Find primary primes associate to $1-2\omega, -7-3\omega$, and $3-\omega$.
}

\begin{proof} 
: \\
\begin{enumerate}
\item[$\bullet$] $(1-2\omega)\omega = 2 + 3 \omega \equiv 2 \pmod 3$, so $2+3\omega$ is primary, and associate to $1-2\omega$.
$N(2+3\omega) = 7$ and 7 is a rational prime, thus $2 + 3\omega$ is a primary prime.
\item[$\bullet$] $-7 - 3 \omega \equiv 2 \pmod 3$.

$N(-7-3\omega) = 37$ and 37 is a rational prime, thus $-7 - 3\omega$ is a primary prime.
\item[$\bullet$] $(3-\omega)\omega^2 = -4 - 3\omega \equiv 2 \pmod 3$, so $-4-3\omega$ is primary, and  associate to $3-\omega$.

$N(-4 - 3 \omega) = 13$ and 13 is a rational prime, thus $-4 - 3 \omega$ is a primary prime.
\end{enumerate}
\end{proof}

\paragraph{Ex. 9.8}

{\it Factor the following numbers into primes in $D$ : $7,21,45,22$, and $143$.
}

\begin{proof}
$7=N(2+3\omega)$, thus $ 7 = (2+3\omega)(2+3\omega^2) = (2+3\omega)(-1-3\omega)$.

$21 = 3\times 7 = -\omega^2 \lambda^2 (2+3\omega)(-1-3\omega)$  since $3=-\omega^2(1-\omega)^2$.

$45 = 3^2\times 5 = \omega \lambda^4 5$

$22=2\times 11$ (2 and 11 are primes in $D$)

$143 = 11\times 13 = 11(-4-3\omega)(-4-3\omega^2) = 11  (-4-3\omega)(-1+3\omega)$
\end{proof}

\paragraph{Ex. 9.9}
{\it Show that $\overline{\alpha} \ne 0$, the residue class of $\alpha$, is a cube in the field $D/\pi D$ iff $\alpha^{(N\pi -1)/3} \equiv 1 \pmod \pi$. Conclude that there are $(N\pi - 1)/3$ cubes in $(D/\pi D)^*$.
}

\bigskip
Solution 1 : 
\begin{proof}
Let $\pi$ a prime in $D$, $N\pi \ne 3$, and $\alpha \in D,\pi \nmid \alpha$.

$\overline{\alpha}$ is a cube in $(D/\pi D)^*$

$\iff x^3 \equiv \alpha \pmod \pi$ has a solution

$\iff \chi_{\pi}(\alpha)= 1$ (by Prop. 9.3.3(a))

$\iff \alpha^{\frac{N\pi-1}{3}} \equiv 1 \pmod \pi$

$\iff \overline{\alpha}^{\frac{N\pi-1}{3}}  = \overline{1}$.

The cubes in $(D/\pi D)^*$ are then the roots of the polynomial $f(x) = x^{\frac{N\pi-1}{3}} - \overline{1}$ in $D/\pi D$. 

As $d = |D/\pi D| = N\pi$, $(N\pi - 1)/3 \mid q-1$, $f(x) \mid x^{q-1}-1 \mid x^q-x$. By Corollary 2 of Proposition 8.1.1, $f$ has $\deg(f) = \frac{N\pi-1}{3}$ roots.

Conclusion  : there exist exactly $\frac{N\pi-1}{3}$ cubes in $(D/\pi D)^*$.
\end{proof}

Solution 2 :
\begin{proof}
Let $\varphi : (D/\pi D)^* \to (D/\pi D)^*$ the group homomorphism defined by $\varphi(x) = x^3$.

Then $\mathrm{im}(\varphi)$ is the set of cubes in $(D/\pi D)^*$.

The equation $x^3 = \overline{1}$ has three distinct solutions $\overline{1}, \overline{\omega}, \overline{\omega}^2$  in $D/ \pi D$ if $N\pi \ne 3$ (see the demonstration of Proposition 9.3.1).

So $\ker(\varphi)= \{\overline{1}, \overline{\omega}, \overline{\omega}^2\}$ and $| \ker(\varphi)| = 3$. Thus $| \mathrm{im} \varphi | = | (D/\pi D)^* \ / |\ker(\varphi) | = (N\pi - 1)/3$. There exist exactly $\frac{N\pi-1}{3}$ cubes in $(D/\pi D)^*$.
\end{proof}

Note : if $N\pi = 3$, that is to say if $\pi$ is associate to $1-\omega$, $D/\pi D = \{\overline{0},\overline{1}, \overline{2}\}$. As $\overline{1}^3 = \overline{1}, \overline{2}^3 = \overline{2}$, all the elements of $(D/\pi D)^*$ are cubes.

\paragraph{Ex. 9.10}

{\it What is the factorisation of $x^{24}-1$ in $D/5D$.
}

\begin{proof}
$\vert (D/5D)^*\vert = N(5) - 1 = 24$, thus $x^{24} - 1 = \prod\limits_{\alpha \in (D/ 5 D)^*} (x - \alpha)$.

( $\alpha = a + b\, \overline{\omega},\  0 \leq a <5, 0 \leq b <5$).
\end{proof}

\paragraph{Ex. 9.11}

{\it How many cubes are there in $D/5D$ ?
}

\begin{proof}
By Exercise 9.9, there exist $(N(5) - 1)/3 = 8$ cubes in $D/5D$.
\end{proof}

\paragraph{Ex. 9.12}

{\it Show that $\omega \lambda$ has order 8 in $D/5D$ and that $\omega^2 \lambda$ has order 24. [Hint : Show first that $(\omega \lambda)^2$ has order 4.]
}

\begin{proof}
$\alpha = (\omega \lambda)^2 = \omega^2 (1-\omega)^2 = \omega^2(1 + \omega^2-2 \omega) = \-3\omega^3= -3$.

$\alpha^2 =9 \equiv -1\pmod 5, \alpha^4 \equiv 1 \pmod 5$, thus $\alpha= (\omega \lambda)^2$ is of order 4 in $D/5D$, and $\omega \lambda$ of order 8.

Let $\beta = \omega^2 \lambda$. $\vert (D/5 D)^* \vert = 24$, thus  $\overline{\beta}^{24} = 1$.

To verify that $\overline{\beta}$ has order 24, it is sufficient to verify $\overline{\beta}^{8}\neq 1,\overline{\beta}^{12}\neq 1$ :

$\beta^8 = \omega ^{16} \lambda^8 = \omega \lambda^8 = (\omega \lambda)^8 \omega^2 \equiv  \omega^2 \not \equiv 1 \pmod 5$.

$\beta^{12} = (\omega^2 \lambda)^{12} = \lambda^{12} = (\omega \lambda)^{12} \equiv  (\omega \lambda)^{4}  \equiv -1 \pmod 5$ (since $(\omega \lambda)$ has order 8 in $D/5D$).


Conclusion : $\omega \lambda$ has order 8, $\omega \lambda^2$ has order 24.
\end{proof}

\paragraph{Ex. 9.13}

{\it Show that $\pi$ is a cube in $D/5D$ iff $\pi \equiv 1,2,3,4,1+2\omega, 2 + 4\omega, 3 + \omega$, or $4+3\omega \pmod 5$.
}

\begin{proof}
Let $\pi \in D, \overline{\pi} \neq 0$. Then $\overline{\pi} $ is a cube in $D/5D$ iff $\overline{\pi}^{(q^2-1)/3} = 1$, with $q = 5$, namely $\overline{\pi}^8 = 1$ (Prop. 7.1.2, where $3 \mid q^2-1 = 24 = |(D/5D)^*| $).

By Exercise 9.12, the class of $\gamma = \omega \lambda$ has order 8, thus the 8 elements $\overline{\gamma}^k, 0 \leq k \leq 7$ are distinct roots of the polynomial $x^8-1$, which has at most 8 roots. Therefore  the subgroup of cubes in $(D/5D)^*$ is
$$\{1 ,\overline{\gamma}, \overline{\gamma}^2,\ldots, \overline{\gamma}^7\}.$$
$\gamma=\omega(1-\omega) = \omega+1+\omega = 1 + 2\omega$, so
\begin{align*}
\gamma^0 &= 1\\
\gamma^1 & = 1 + 2\omega\\
\gamma^2 &\equiv -3 \equiv 2\ [5]\qquad (\mathrm{Ex}.\ 9.12)\\
\gamma^3 &= -3 - 6\omega \equiv 2 + 4 \omega \ [5]\\
\gamma^4&\equiv -1 \equiv 4\ [5]\\
\gamma^5 &\equiv -1 - 2 \omega \equiv 4 + 3\omega\ [5]\\
\gamma^6 &\equiv 3 \ [5]\\
\gamma^7 &\equiv 3+6\omega \equiv 3 + \omega \ [5]
\end{align*}
Conclusion : If $\pi \not \equiv 0 \pmod 5$, $\pi \equiv \alpha^3 \pmod 5,\alpha \in D$ iff 

$$\pi \equiv 1,2,3,4,1+2\omega,2+4\omega,3+\omega,4+3\omega\ [5].$$ 
\end{proof}

\paragraph{Ex. 9.14}

{\it For which primes $\pi \in D$ is $x^3 \equiv 5 \pmod \pi$ solvable ?
}

\begin{proof}
If $\pi$ is a primary prime, and not an associate of 5, the Law of Cubic Reciprocity gives
\begin{align*}
5\equiv x^3 \ [\pi], x \in D &\iff \chi_\pi(5)=1\\
&\iff \chi_5(\pi)=1\\
&\iff  \pi \ \mathrm{ is\ a\ cube\ in\  } D/5D\\
&\iff \pi \equiv1,2,3,4,1+\omega,2+4\omega,3+\omega,4+3\omega \ [5]
\end{align*}
(see Ex. 9.13)

\bigskip

Conclusion : the equation $5\equiv x^3 \ [\pi], x \in D $ is solvable iff the primary prime associate to $\pi$ is congruent modulo 5 to $1,2,3,4,1+2\omega,2+4\omega,3+\omega,4+3\omega$.

Examples : 

$\bullet$ $q=23$ is a primary prime congruent to 3 modulo 5, thus the equation $x^3 \equiv 5\pmod{23}$ has a solution $x  \in D$ ($x = 19)$.

$\bullet$ $-4 - 3 \omega$ is the primary prime associate to the prime $3- \omega$, and $-4 - 3 \omega \equiv 1 + 2 \omega \pmod 5$, thus the equation $x^3 \equiv 5 \pmod {3-\omega}$ has a solution $a + b \omega \in \Z[\omega]$.

Indeed , $7^3 \equiv 5^3 \equiv 11^3 \equiv 5 \pmod {13}$, and $3 - \omega \mid 13$, so $7^3 \equiv 5^3 \equiv 11^3 \equiv 5 \pmod{ 3 - \omega}$.
\end{proof}

\paragraph{Ex. 9.15}

{\it Suppose that $p \equiv 1 \pmod 3$ and that $p = \pi \overline{\pi}$, where $\pi$ is a primary prime in $D$. Show that $x^3 \equiv a \pmod p$ is solvable in $\Z$ iff $\chi_{\pi}(a) = 1$ . We assume that $a \in \Z$.
}

\begin{proof}
As $\pi \mid p$, if $ a \equiv x^3 \pmod p, x \in \Z$, then $ a \equiv x^3 \pmod \pi$, thus $\chi_{\pi}(a) = 1$.

Reciprocally, suppose that $\chi_{\pi}(a) = 1$. Then the equation $a \equiv y^3 \pmod \pi$ has a solution $y = u + v \omega, \ u,v \in \Z$. Moreover, $\overline{y}$ has a representant $x \in \Z$ modulo $\pi$ :
$$y\equiv  x \pmod \pi, x \in \Z.$$

So $a \equiv x^3$ has a solution $x \in \Z$.

Thus $\pi \mid a-x^3, N(\pi) = p \mid (a-x^3)^2$, therefore $p \mid a-x^3$ and so $a \equiv x^3 \pmod p$.

Conclusion ; if $p\equiv 1 \pmod 3$ , $p = \pi \overline{\pi}$, where $\pi$ is is a primary prime  and $a \in \Z$,
$$\exists x \in \Z, \ a \equiv x^3 \pmod p \iff \chi_{\pi}(a) = 1.$$
In other words, $x^3 \equiv a \pmod \pi$ is solvable in $D$ iff it is solvable in $\Z$.
\end{proof}

\paragraph{Ex. 9.16}

{\it Is $x^3 \equiv 2 - 3\omega \pmod {11}$ solvable ? Since $D/11D$ has 121 elements this is hard to resolve by straightforward checking. Fill in the details of the following proof that it is not solvable. $\chi_{\pi}(2 - 3 \omega) = \chi_{2-3\omega}(11)$ and so we shall have a solution iff $x^3 \equiv 11 \pmod {2-3\omega}$ is solvable. This congruence is solvable iff $x^3 = 11\pmod 7$ is solvable in $\Z$. However, $x^3 \equiv a \pmod 7$ is solvable in $\Z$ iff $a \equiv 1$ or $6 \pmod 7$.
}

\bigskip
Warning : false sentence, since 
$$N(2 - 3 \omega) = (2-3\omega)(2 - 3 \omega^2) = 4 + 9 -6(\omega+\omega^2) = 4 + 9 + 6 = 1\ (\mathrm{and}\ \mathrm{not}\ 7!).$$
\begin{proof}
As $19$ is a rational prime, and $\pi= 2 - 3\omega$ and $11$  are primary primes, by Exercise 9.15,
\begin{align*}
\exists x \in D,\ 2-3\omega \equiv x^3\ [11]&\iff \chi_{11}(2-3\omega) = 1\\
&\iff \chi_{2-3\omega}(11)=1\\
&\iff \exists x \in \mathbb{Z},\  x^3 \equiv 11\  [19]
\end{align*}
Moreover 
$$\exists x \in \mathbb{Z},\  x^3 \equiv 11\  [19] \iff 11^6 \equiv 1 \pmod {19},$$
which is true : $11^6 = 121^3 = (19 \times 6 + 7)^3 \equiv 49 \times 7 \equiv 11 \times 7 \equiv 77 \equiv 1 \ [19]$.

Conclusion : there exists $x \in D$ such that $2-3\omega  \equiv x^3 \pmod {11}$.

We a little programming, we find a solution $x = 1 + 8\omega$ (and its associates $\omega^2 x =  7 - \omega, \omega x = -8- 7\omega \equiv 3 + 4 \omega \pmod{11} $) :
$$x^3 = (1+8\omega)^3 = 321 - 168 \omega \equiv 2 - 3 \omega \pmod {11}.$$
\end{proof}


\paragraph{Ex. 9.17}

{\it An element $\gamma \in D$ is called primary if $\gamma \equiv2 \pmod 3$. If $\gamma$ and $\rho$ are primary, show that $-\gamma \rho$ is primary. If $\gamma$ is primary, show that $\gamma = \pm \gamma_1\gamma_2\ldots \gamma_t$, where the $\gamma_i$ are (not necessarily distinct) primary primes.
}

\begin{proof}
If $\gamma \equiv 2, \rho \equiv 2 \pmod 3$, then $-\gamma \rho \equiv -2 \times 2 \equiv 2 \pmod 3$, so $-\gamma \rho$ is primary.

\bigskip

By Ex. 9.2, $\gamma$ can be  written 
$$\gamma = (-1)^a \omega^b \lambda^c \pi_1^{a_1}\cdots \pi_t^{a_t},$$
where $\pi_i \equiv 2 \pmod 3, a \in \{0,1\}, b \in \{0,1,2\}$.

As $\pi_i \equiv -1 \pmod 3$, and $\gamma \equiv -1 \pmod 3$, we obtain $\omega^b \lambda^c \equiv \pm 1 \pmod 3$. We prove that $b = c = 0$.

$\lambda^2 = (1-\omega)^2 = -3\omega \equiv 0 \pmod 3$. If $c \geq 2$, we woulfd obtain $\gamma \equiv 0 \pmod 3$, in contradiction with the hypothesis, thus $c = 0$ or $c = 1$.

If $c=1$, $\omega^b\lambda^c \in \{1-\omega, \omega(1-\omega) = 1+2\omega, \omega^2(1-\omega) = - 2 - \omega$. Since $1-\omega \not \equiv \pm 1, 1+2\omega \not \equiv \pm 1, - 2 - \omega \not \equiv \pm 1 \pmod 3$, this is impossible, so $c=0$.
$\omega^b \in \{1,\omega, -1-\omega$. Since $\omega \not \equiv \pm1 \pmod 3$, and $-1 - \omega \not \equiv \pm 1 \pmod 3$, then $\omega^b = 1, 0 \leq b \leq 2$, thus $b=0$.

Finally, $\gamma = (-1)^a \pi_1^{a_1}\cdots \pi_t^{a_t}$.

Conclusion : every primary $\gamma \in D$ is under the form
$$\gamma = \pm \gamma_1\gamma_2\cdots \gamma_t,$$
where the $\gamma_i$ are primary primes.
\end{proof}

\paragraph{Ex. 9.18}

{\it (continuation) If $\gamma = \pm \gamma_1 \gamma_2\cdots \gamma_t$ is a primary decomposition of the primary element $\gamma$, define $\chi_{\gamma}(\alpha) = \chi_{\gamma_1}(\alpha)\chi_{\gamma_2}(\alpha)\cdots\chi_{\gamma_t}(\alpha)$. Prove that $\chi_{\gamma}(\alpha) = \chi_{\gamma}(\beta)$ if $\alpha \equiv \beta \pmod \gamma$ and $\chi_{\gamma}(\alpha \beta) = \chi_\gamma(\alpha) \chi_\gamma(\beta)$. If $\rho$ is primary, show that $\chi_\rho(\alpha) \chi_\gamma(\alpha) = \chi_{-\rho \gamma}(\alpha)$.
}

\begin{proof}
If $\alpha \equiv \beta\ [\gamma]$, then $\alpha \equiv \beta\pmod {\gamma_i}, 1 \leq i \leq t$, so $\chi_{\gamma_i}(\alpha) = \chi_{\gamma_i}(\beta)$, thus $\chi_\gamma(\alpha) = \chi_\gamma(\beta)$.

By Proposition 9.3.3,
\begin{align*}
\chi_\gamma(\alpha \beta) &= \chi_{\gamma_1}(\alpha \beta)\chi_{\gamma_2}(\alpha \beta)\cdots\chi_{\gamma_t}(\alpha \beta)\\
&= \chi_{\gamma_1}(\alpha)\chi_{\gamma_2}(\alpha)\cdots\chi_{\gamma_t}(\alpha)\chi_{\gamma_1}(\beta)\chi_{\gamma_2}(\beta)\cdots\chi_{\gamma_t}(\beta)\\
&= \chi_\gamma(\alpha) \chi_{\gamma}(\beta)
\end{align*}
Finally if $\rho = \pm \rho_1\rho_2\cdots\rho_l$ is primary, then $-\rho \gamma = \pm \rho_1\rho_2\cdots\rho_l\gamma_1\gamma_2\cdots\gamma_t$ is primary by Ex. 9.17, therefore

$$\chi_{-\rho \gamma}(\alpha) = (\chi_{\rho_1} \chi_{\rho_2}\cdots \chi_{\rho_l}\chi_{\gamma_1} \chi_{\gamma_2}\cdots \chi_{\gamma_t} )(\alpha)= \chi_\rho(\alpha)\chi_\gamma(\alpha).$$
\end{proof}

\paragraph{Ex. 9.19}

{\it Suppose that $\gamma = A + B \omega$ is primary and that $A = 3M-1$ and $B = 3N$. Prove that $\chi_\gamma(\omega) = \omega^{M+N}$ and that $\chi_\gamma(\lambda) = \omega^{2M}$.
}

\begin{proof}
We verify first that if $\gamma = -\gamma_1 \gamma_2$, with
$$
\begin{array}{lll}
  \gamma = A+B\omega, & A=3M-1,  & B=3N,  \\
   \gamma_1 = A_1+B_1\omega,& A_1= 3M_1-1,  &  B_1=3N_1, \\
  \gamma_2 = A_2+B_2\omega,&  A_2= 3M_2-1, &  B_2=3N_2, 
\end{array}
$$
then $M \equiv M_1+M_2\pmod 3,N \equiv N_1+N_2 \pmod 3$.
$$-\gamma_1 \gamma_2 = -A_1A_2 + B_1 B_2  + (- A_1B_2-A_2B_1+B_1B_2) \omega=A+B\omega,$$
therefore
$$3M-1 = A =-A_1A_2 + B_1 B_2 \equiv 3(M_1+M_2) - 1\pmod 9,$$
thus $M\equiv M_1+M_2\pmod 3.$
$$3N = B = -A_1B_2-A_2B_1+B_1B_2 \equiv 3 (N_1+N_2)\pmod 9,$$ 
thus $N \equiv N_1+N_2 \pmod 3.$

By induction, if $\gamma = \pm \gamma_1 \gamma_2\cdots \gamma_t = (-1)^{t-1} \gamma_1 \gamma_2\cdots \gamma_t$, where $\gamma_i = A_i+B_i\omega,A_i= 3M_i-1,B_i=3N_i$, then
$$M \equiv M_1+\cdots+M_t\pmod 3, N \equiv N_1+\cdots + N_t \pmod 3.$$

By Exercise 9.3,
\begin{align*}
\chi_\gamma(\omega) &= \chi_{\gamma_1}(\omega)\cdots\chi_{\gamma_t}(\omega)\\
&=\omega^{M_1+N_1}\cdots \omega^{M_t+N_t}\\
&=\omega^{(M_1+\cdots+M_t)+(N_1+\cdots+N_t)}\\
&=\omega^{M+N}
\end{align*}

and by Eisenstein's result,
\begin{align*}
\chi_\gamma(\lambda) &= \chi_{\gamma_1}(\lambda)\cdots\chi_{\gamma_t}(\lambda)\\
&=\omega^{2M_1}\cdots \omega^{2M_t}\\
&=\omega^{2(M_1+\cdots+M_t)}\\
&=\omega^{2M}
\end{align*}

Conclusion : if $\gamma = 3M-1+3N\omega$, then

$$\chi_\gamma(\omega) = \omega^{M+N}, \chi_\gamma(\lambda)=\omega^{2M}.$$
\end{proof}

\paragraph{Ex. 9.20}

{\it If $\gamma$ and $\rho$ are primary, show that $\chi_\gamma(\rho) = \chi_\rho(\gamma)$.
}

\begin{proof}

\end{proof}
$\rho, \gamma$ are written
\begin{align*}
\rho&=\pm\rho_1\rho_2\cdots\rho_l,\\
\gamma &= \pm \gamma_1 \gamma_2\cdots \gamma_m, 
\end{align*}
 where $\rho_i,\gamma_i$ are primary primes.
By the law of Cubic Reciprocity, we obtain
\begin{align*}
\chi_\gamma(\rho) &= \prod_{j=1}^m \chi_{\gamma_j}(\rho)\\
& = \prod_{j=1}^m\prod_{i=1}^l \chi_{\gamma_j}(\rho_{i})\\
& = \prod_{i=1}^l\prod_{j=1}^m \chi_{\gamma_j}(\rho_{i})\\
& = \prod_{i=1}^l\prod_{j=1}^m \chi_{\rho_i}(\gamma_j)\\
&=\prod_{i=1}^l \chi_{\rho_i}(\gamma)\\
&=\chi_{\rho}( \gamma)
\end{align*}

\paragraph{Ex. 9.21}

{\it If $\gamma$ is primary, show that there are infinitely many primary primes $\pi$ such that $x^3 \equiv \gamma \pmod \pi$ is not solvable. Show also that there are infinitely many primary primes $\pi$ such that $x^3 \equiv \omega \pmod \pi$ is not solvable and the same for $x^3 \equiv \lambda \pmod \pi$. (Hint: Imitate the proof of Theorem 3 of Chapter 5.)
}

\begin{proof}
\begin{enumerate}
\item[a)] As some primary elements of $D$ may be cubes, by example $53 + 36 \omega = (-1 + 3 \omega)^3$, we must of course suppose that $\gamma$ is not the cube of some element of $D$ (in the contrary case $x^3 \equiv \gamma \pmod \pi $ is solvable for all prime $\pi$).

Note first that for all prime $\pi$ in $D$, there exists $\sigma \in D$ such that $\chi_\pi(\sigma) = \omega$. Indeed, there exist $(N\pi - 1)/3$ cubes in $(D/\pi D)^*$, which has $N\pi - 1$ elements, so there exists an element $\overline{\tau} \in (D/\pi D)^*$ which is not a cube, therefore there exists $\tau \in D$ such that $\chi_\pi(\tau) \neq 1$. If $\chi_\pi(\tau) = \omega$, we put $\sigma = \tau$ and if $\chi_\pi(\tau) = \omega^2$, we put $\sigma = \tau^2$. In the two cases, $\chi_\pi(\sigma) = \omega$.

\bigskip

Let $\gamma \in D$, where $\gamma$ is primary. Then $\gamma = \pm \gamma_2^{n_1}\gamma_1^{n_2}\cdots\gamma_p^{n_p}$, where the $\gamma_i$ are distinct primary primes. 
Write $n_i = 3q_i + r_i, \ r_i \in \{0,1,2\}$. Then grouping in $\gamma'$ the $r_i \ne 0$, we can write $\gamma = \delta^3 \gamma', \gamma' = \gamma_1^{r_1} \gamma_2^{r_2}\cdots \gamma_l^{r_l}, r_i \in \{1,2\}, \delta \in D$ ($-1$ is a cube). Since by hypothesis $\gamma$ is not a cube, $l\geq 1$. Moreover the equation $x^3 \equiv \gamma \pmod \pi$ is solvable iff $x^3 \equiv \gamma' \pmod \pi$ is solvable. We may then suppose $$\gamma = \gamma_1^{r_1} \gamma_2^{r_2}\cdots \gamma_l^{r_l}, 1\leq r_i \leq 2,$$ without cubic factors.

Note that the $\gamma_i$ are not associate to $\lambda = 1-\omega$ (see Ex. 9.17).

Let $A = \{\lambda_1,\lambda_2,\ldots, \lambda_k\}$  a set (possibly empty) of distinct primary primes $\lambda_i$ (therefore  they are not associate), and not associate neither to $\gamma_i, 1 \leq i \leq l$, nor $\lambda = 1 - \omega$.

We will show that we can find a primary prime $\lambda_{k+1}$ distinct of the $\lambda_i$ with the same properties and such that the equation $x^3 \equiv \lambda \pmod {\lambda_{k+1}}$ is not solvable. This proves the existence of infinitely many primes $\pi$ such that the equation $x^3 \equiv \lambda \pmod \pi$ is not solvable.

With the initial note, let $\sigma \in D$ such that $\chi_{\gamma_l}(\sigma) = \omega$. As $D$ is a principal ideal domain, the Chinese Remainder Theorem is valid. Since $3 = \lambda \overline{\lambda}$ is relatively prime to $\gamma_i, \lambda_i$, there exists $\beta \in D$ such that
\begin{align*}
\beta &\equiv 2 \ [3]\\
\beta &\equiv 1 \ [\lambda_i] \hspace{1cm} (1\leq i\leq k)\\
\beta &\equiv 1 \ [\gamma_i] \hspace{1cm} (1 \leq i \leq l-1)\\
\beta &\equiv  \sigma \ [\gamma_l]\\
\end{align*}
The first equation show that $\beta$ is primary, so $\beta= (-1)^{m-1} \beta_1\ldots \beta_m$, where the $\beta_i$ are primary primes.

By Exercise 9.20,
$$\chi_\beta(\gamma) = \chi_\beta(\gamma_1)^{r_1}\cdots\chi_\beta(\gamma_l)^{r_l} = \chi_{\gamma_1}(\beta)^{r_1}\cdots\chi_{\gamma_l}(\beta)^{r_l}.$$
As $\chi_\beta(\gamma) = \chi_{\gamma_i}(1) = 1 \ (1\leq i \leq l-1)$, and $\chi_{\gamma_l}(\beta) = \chi_{\gamma_l}(\sigma) =\omega$, we obtain $\chi_\beta(\gamma) = \omega^{r_l} \neq 1$, since $r_l =$ or $r_l = 2$.

By Exercise 9.18, $\chi_\rho(\alpha) \chi_\gamma(\alpha) = \chi_{-\rho \gamma}(\alpha)$, with primary $\rho, \gamma$, so by induction, as $\beta= (-1)^{m-1} \beta_1\cdots\beta_m$,
$$\chi_\beta(\gamma) = \chi_{\beta_1}(\gamma)\cdots\chi_{\beta_m}(\gamma) \neq 1.$$
Thus there exists a subscript $j$ such that $\chi_{\beta_j}(\gamma) \neq 1$.

We can then take $\lambda_{k+1} = \beta_j$. Indeed, as $\beta \equiv 1 \ [\lambda_i]$ and $\beta \not \equiv 0\ [\gamma_i]$, $\beta_j$ is distinct of the $\lambda_i$ and $\gamma_i$, and $\beta_j$ is not associate to $\lambda$ since $\beta \equiv 2 \pmod 3$.

As $\chi_{\lambda_{k+1}}(\gamma) \neq 1$, the equation $x^3 \equiv \gamma \ [\lambda _{k+1}]$ is not solvable, so $\lambda_{k+1}$ is convenient. 

Conclusion : if $\gamma \in D$ is primary and is not a cube in $D$, there exist infinitely many primes $\pi \in D$ such that the equation $x^3 \equiv \lambda \ [\pi]$ is not solvable.
\item[b)] We show that $x^3 \equiv \omega \ [\pi]$ has no solution for infinitely many primes $\pi$.

To begin the induction, we display such a prime $\pi$, namely $\pi = 2+ 3 \omega$. Indeed, $N(\pi) = 4 + 9 - 6 = 7$, 7 is a rational prime, so $\pi$ is a primary prime in $D$, of the form $\pi = 3m-1 + 3n\omega$, with $n = m =1$, so $\chi_\pi(\omega) = \omega^{m+n} = \omega^2 \neq 1$ : the equation $x^3 \equiv \omega \ [\pi]$ is not solvable. Moreover $\pi$ is not associate to $\lambda = 1 - \omega$.

Suppose now the existence of a set $A = \{\lambda_1,\lambda_2,\ldots,\lambda_l\}, l \geq 1$, of distinct primary primes $\lambda_i$, not associate to $\lambda$ and such the equation $x^3 \equiv \omega\ [\lambda_i]$ is not solvable. We will show that we can add a prime $\lambda_{l+1}$  to the set $A$ with the same properties.


Let $$\beta = 3(-1)^{l-1} \lambda_1\cdots\lambda_l - 1.$$

$(-1)^{l-1} \lambda_1\cdots\lambda_l$ is primary, so $(-1)^{l-1} \lambda_1\cdots\lambda_l = 3m-1 + 3n\omega,\ m,n \in \Z$.

$\beta = 3(3m-1 + 3n\omega) - 1 = 3(3m-1) - 1 + 9n\omega = 3M-1 + 3 N \omega$, where $M = 3m-1, N = 3n$. By Exercise 9.19,
$$\chi_\beta(\omega) = \omega^{M+N} = \omega^{3m-1+3n} = \omega^2 \neq 1.$$
As $\beta = \pm \beta_1\cdots\beta_m$, where the $\beta_i$ are primary primes, $\chi_\beta(\omega) = \chi_{\beta_1}(\omega) \cdots \chi_{\beta_m}(\omega) \neq 1$, so there exists a subscript $i$ such that $\chi_{\beta_i}(\omega) \ne 1$. 

Since $\beta = 3(-1)^{l-1} \lambda_1\cdots\lambda_l - 1$, $\beta_i$ is associate neither to $\lambda_i$ nor to $\lambda$. Moreover $\chi_{\beta_i}(\omega)\ne 1$, thus the equation $x^3 \equiv \omega\ [\beta_i]$ is not solvable : $\lambda_{l+1} = \beta_i$ is convenient.

Conclusion : the equation $x^3 \equiv \omega \ [\pi]$ is not solvable for infinitely many primes $\pi$.

\item[c)] We show that $x^3 \equiv \lambda \ [\pi]$ has no solution for infinitely many primes $\pi$.

To begin the induction, we display such a prime $\pi$, namely $\pi = -4 + 3 \omega$. Indeed, $N(\pi) = 16 + 9 + 12 = 37$, 37 is a rational prime, so $\pi$ is a primary prime in $D$, of the form $\pi = 3m-1 + 3n\omega$, with $m=-1,n=1$, so $\chi_\pi(\lambda) = \omega^{2m} = \omega \neq 1$ : the equation $x^3 \equiv \lambda \ [\pi]$ is not solvable.

Suppose now the existence of a set $A = \{\lambda_1,\lambda_2,\ldots,\lambda_l\}, l \geq 1$, of distinct primary primes $\lambda_i$, not associate to $\lambda$ and such the equation $x^3 \equiv \lambda\ [\lambda_i]$ is not solvable. We will show that we can add a prime $\lambda_{l+1}$  to the set $A$ with the same properties.

Let $$\beta = 3(-1)^{l-1} \lambda_1\cdots\lambda_l - 1.$$
$(-1)^{l-1} \lambda_1\cdots\lambda_l$ is primary, so $(-1)^{l-1} \lambda_1\cdots\lambda_l = 3m-1 + 3n\omega,\ m,n \in \Z$.

$\beta = 3(3m-1 + 3n\omega) - 1 = 3(3m-1) - 1 + 9n\omega = 3M-1 + 3 N \omega$, where $M = 3m-1, N = 3n$. By Exercise 9.19,
$$\chi_\beta(\lambda) = \omega^{2M} = \omega^{2(3m-1)} = \omega \neq 1.$$
As $\beta = \pm \beta_1\cdots\beta_m$, where the $\beta_i$ are primary primes, $\chi_\beta(\omega) = \chi_{\beta_1}(\omega) \cdots \chi_{\beta_m}(\omega) \neq 1$, so there exists a subscript $i$ such that $\chi_{\beta_i}(\lambda) \ne 1$. 

Since $\beta = 3(-1)^{l-1} \lambda_1\cdots\lambda_l - 1$, $\beta_i$ is associate neither to $\lambda_i$ nor to $\lambda$. Moreover $\chi_{\beta_i}(\lambda)\ne 1$, thus the equation $x^3 \equiv \lambda\ [\beta_i]$ is not solvable : $\lambda_{l+1} = \beta_i$ is convenient.

Conclusion : the equation $x^3 \equiv \lambda \ [\pi]$ is not solvable for infinitely many primes $\pi$.

\end{enumerate}
\end{proof}

\paragraph{Ex. 9.22}

{\it (continuation) Show in general that if $\gamma \in D$ and $x^3 \equiv \gamma \pmod \pi$ is solvable for all but finitely finitely many primary primes $\pi$, then $\gamma$ is a cube in $D$.
}

\begin{proof}
Let $\gamma \in D$ and suppose that $\gamma$ is not a cube in $D$. We will show that the equation $x^3 \equiv \gamma \ [\pi]$ is not solvable for infinitely primes $\pi \in D$.

By Exercise 9.2, we can write
$$\gamma = (-1)^u\omega^v \lambda^w \gamma_1^{n_1}\cdots\gamma_p^{n_p},$$
where the $\gamma_i$ are distinct primary primes. Let $v = 3q + b, w = 3q' +c, n_i = 3q_i +r_i$, with the remainders $b,c,r_i$ in $\{0,1,2\}$. Grouping the factors with null remainders, we obtain $\gamma = \delta^3 \gamma', \gamma' = \omega^b \lambda^c\gamma_1^{r_1}\cdots \gamma_l^{r_l}$, with  $b,c,r_i$ in $\{1,2\}, \delta \in D, l \geq 0$ ($-1$ is a cube).

Moreover the equation $x^3 \equiv \gamma \ [\pi]$ is solvable iff the equation $x^3 \equiv \gamma'\ [\pi]$ is solvable. So we may suppose that 
$$\gamma =  \omega^b \lambda^c\gamma_1^{r_1}\cdots \gamma_l^{r_l},\qquad b\in \{1,2\}, c\in \{1,2\}, r_i \in \{1,2\},$$
without cubic factors.

\begin{enumerate}
\item[$\bullet$] Case 1 : $l\geq 1$.

Let $A = \{\lambda_1,\ldots,\lambda_k\}$ a possibly empty set of distinct primary primes $\lambda_i$, distinct of the $\gamma_i$ and such that the equation $x^3 \equiv \gamma \ [\lambda_i]$ is not solvable. We will show that we can add a prime $\lambda_{k+1}$ with the same properties.

Suppose that $l\geq 1$. We have proved in Ex. 9.21 that there exists $\sigma \in D$ such that $\chi_{\gamma_l}(\sigma) = \omega$. Let $\beta \in D$ such that
\begin{align*}
\beta &\equiv -1\ [9]\\
\beta & \equiv 1 \ [\lambda_i], 1 \leq i \leq k\\
\beta & \equiv 1 \ [\gamma_i], 1 \leq i \leq l-1\\
\beta & \equiv \sigma\  [\gamma_l]
\end{align*}
$\beta \equiv -1 \ [9]$, thus $\beta \equiv -1 \ [3]$ : $\beta$ is primary, of the form $\beta = 3M-1+3N\omega$.

$\beta = 3M-1+3N\omega \equiv -1 \ [9]$, so $3M+3N\omega \equiv 0 \ [9]$, $M+N\omega \equiv 0 \ [3]$, thus $3\mid M,3\mid N$.

By Exercise 9.18,
\begin{align*}
\chi_\beta(\omega) &= \omega^{M+N} = 1\\
\chi_\beta(\lambda) &= \omega^{2M} = 1
\end{align*}
As $\beta$ and $\gamma_i$ are primary, $\chi_\beta(\gamma_i) = \chi_{\gamma_i}(\beta) = \chi_{\gamma_i}(1) = 1\ (1\leq i \leq l-1)$. 

$\chi_\beta(\gamma) =\chi_\beta(\omega)^b \chi_\beta(\lambda)^c\chi_\beta(\gamma_1)^{r_1}\cdots\chi_\beta(\gamma_l)^{r_l} = \chi_{\beta}(\gamma_l)^{r_l} = \chi_{\gamma_l}(\beta)^{r_l} = \chi_{\gamma_l}(\sigma)^{r_l} = \omega^{r_l}  \neq 1$, since $r_l \in \{1,2\}$. 

$\beta = \pm \beta_1\cdots \beta_m$, with $\beta_i$ primary primes, therefore
$$\chi_\beta(\gamma) = (\chi_{\beta_1}\cdots \chi_{\beta_m})(\gamma) \neq 1. $$ Thus there exists a subscript $i$ such that $\chi_{\beta_i}(\gamma) \ne 1$, so $x^3 \equiv \gamma\ [\beta_i]$ is not solvable. Moreover $\beta \equiv 1 \ [\gamma_i]$, so $\beta_i$ is not associate to any $\gamma_j$. Similarly, $\beta_i$ is not associate to any $\gamma_j$. $\lambda_{k+1} = \beta_i$ is convenient.

So there exist infinitely many $\pi$ such that $x^3 \equiv \gamma \ [\pi]$ is not solvable.


\item[$\bullet$] Case 2 : $l = 0$, so $\gamma = \omega^b\lambda^c,\ 1\leq b \leq 2, 1 \leq c \leq 2$.

$\pi_0 = 2 - 3 \omega$ is a primary prime ($N(\pi_0) = 19$).

Let $A = \{\lambda_1,\ldots,\lambda_k\}$ a possibly empty set of distinct primary primes $\lambda_i \neq \pi_0$ such that the equation $x^3 \equiv \gamma \ [\lambda_i]$ is not solvable. We will show that we can add a prime $\lambda_{k+1}$ with the same properties.

Let $\beta = 9 (-1)^{k-1} \lambda_1\cdots \lambda_k + 2-3\omega$.

$\beta\equiv 2 \ [3]$ : $\beta$ is primary.

Moreover $(-1)^{k-1} \lambda_1\cdots \lambda_k $ is primary, of the form 

$$(-1)^{k-1} \lambda_1\cdots \lambda_k  = 3m-1+3n\omega, m \in \mathbb{Z},n\in \mathbb{Z}.$$

\begin{align*}
\beta&=9(3m-1+3n\omega)+2-3\omega\\
&=27m-7+(27n-3)\omega\\
&=3(9m-2)-1+3(9n-1)\omega\\
&=3M-1+3N\omega
\end{align*}

where $M=9m-2,N=9n-1$

\begin{align*}
\chi_\beta(\omega) &= \omega^{M+N} = \omega^{9m-2+9n-1}=1\\
\chi_\beta(\lambda) &=\omega^{2M} = \omega^{2(9m-2)}=\omega^2\neq 1
\end{align*}

$\beta = \pm\beta_1\cdots\beta_m$, where the $\beta_i$ are primary primes.

$\chi_\beta(\gamma) = \chi_\beta(\omega)^b \chi_\beta(\lambda)^c = \omega^{2c} \neq 1$ since $c = 1$ or $c = 2$.
$$\chi_\beta(\gamma) = (\chi_{\beta_1}\cdots \chi_{\beta_m})(\gamma) \neq 1. $$ Thus there exists a subscript $i$ such that $\chi_{\beta_i}(\gamma) \ne 1$, so $x^3 \equiv \gamma\ [\beta_i]$ is not solvable. 

As $\beta_i \mid \beta = 9 (-1)^{k-1} \lambda_1\cdots \lambda_k + 2-3\omega$, if $\beta_i = \lambda_j$ for some subscript $j$, $\lambda_j \mid \pi_0 = 2 - 3\omega$, so $\lambda_j = \pi_0$, which is a contradiction, thus $\beta_i \not \in A$. Similarly, if  $\beta_i = \pi_0 = 2 - 3\omega$, then $\pi_0 \mid 9 \lambda_1\cdots\lambda_k$, and $\pi_0$ is relatively prime to $\lambda$, so $\pi_0 = \lambda_j$ for some subscript $j$ : this is a contradiction, thus $\beta_i \ne \pi_0$. $\lambda_{k+1} = \beta_i$ is convenient.

So there exist infinitely many $\pi$ such that $x^3 \equiv \gamma \ [\pi]$ is not solvable.

$\bullet$ Conclusion :

if $\gamma$ is not a cube in $D$, there exist infinitely many primes $\pi$ such that $x^3 \equiv \gamma \ [\pi]$ is not sovable.

By contraposition, if the equation $x^3 \equiv \gamma \ [\pi]$ is solvable for every prime $\pi$, at the exception perhaps of the primes in a finite set, then $\gamma$ is a cube in $D$.

\end{enumerate}
\end{proof}

\paragraph{Ex. 9.23}

{\it Suppose that $p\equiv 1 \pmod 3$. Use Exercise 5 to show that $x^3 \equiv 3 \pmod p$ is solvable in $\Z$ iff $p$ is of the form $4p = C^2 + 243 B^2$.
}

\begin{proof}
Let $p$ a rational prime, $p \equiv 1 \pmod 3$, then $p = \pi \overline{\pi}$, where $\pi \in D$ is a primary prime : $\pi = a + b \omega = 3m-1 + 3 \omega$.
\begin{enumerate}
\item[$\bullet$] Suppose that there exists $x \in \Z$ such that $x^3 \equiv 3 \pmod p$. Then $x^3 \equiv 3 \pmod \pi$, so $\chi_\pi(3) = 1$. By Exercise 9.5, $\omega^{2n} = \chi_\pi(3) = 1$, thus $3 \mid n$, therefore $9 \mid b = 3n$, namely $b = 9B, B \in \Z$.

$p = N\pi = a^2+b^2 -ab, 4p = (2a-b)^2+3b^3 = C^2 + 243 B^2$, where $C = 2a-b,B=b/9$.
So there exists $C,B\in \Z$ such that $4p = C^2 + 243B^2$.
\item[$\bullet$] Reciprocally, suppose that there exist $C,B \in \Z$ such that $4p = C^2 + 243 B^2$.

As $4p = (2a-b)^2 + 3 b^2 = C^2 + 3(9B)^2$, from the unicity proved in Exercise 8.13, we obtain $b = \pm9B$, so $9 \mid b=3n, 3 \mid n$, and $\chi_\pi(3) = \omega^{2n} = 1$.

Thus there exists $x \in D$ such that $x^3 \equiv 3 \pmod \pi$. As $p \equiv 1\pmod 3$, $D/\pi D = \{\overline{0},\ldots,\overline{p-1}\}$, so there exists $h \in \Z$ such that $x \equiv h \pmod \pi$, and $h^3 \equiv 3 \pmod \pi$.

Therefore $p = N\pi \mid N(h^3 - 3)$, namely $p \mid (h^3-3)^2$, where $p$ is a rational prime, thus $p \mid h^3 -3$ : there exists $x \in \Z$ such that $x^3 \equiv 3 \pmod p$.

Moreover $4p = C^2 + 243 B^2$ implies $p \equiv 1 \pmod 3$.

$$(p\equiv 1 \ [3]\ \mathrm{and}\ \exists x \in \mathbb{Z}, x^3 \equiv 3 \ [p] )\iff \exists C \in \mathbb{Z}, \exists B \in \mathbb{Z}, 4p = C^2+243 B^2.$$
\end{enumerate}
\end{proof}

\paragraph{Ex. 9.24}

{\it Let $\pi = a +b \omega$ be a complex primary element of $D = \Z[\omega]$. Put $a = 3m-1,b=3n,p = N(\pi)$.
\begin{enumerate}
\item[(a)] $(p-1)/3 \equiv -2m + n \pmod 3$.
\item[(b)] $(a^2-1)/3 \equiv m \pmod 3$.
\item[(c)] $\chi_\pi(a) = \omega^m$.
\item[(d)] $\chi_\pi(a+b) = \omega^{2n} \chi_\pi(1-\omega)$.
\end{enumerate}
}

\begin{proof}
As $N\pi = p$ is a rational prime, $\pi$ is a primary prime.
\begin{enumerate}
\item[(a)]$p-1 = (3m-1)^2+(3n)^2-3n(3m-1) - 1 \equiv -6m + 3n \pmod 9$, thus $$\frac{p-1}{3} \equiv -2m + n \pmod 3.$$
\item[(b)]$a^2 - 1 = (3m-1)^2-1 \equiv -6m \pmod 9$, thus
$$\frac{a^2-1}{3} \equiv m \pmod 3.$$
\item[(c)]  As $\pi,a$ are primary, by Exercise 9.20, $\chi_\pi(a) = \chi_a(\pi)$.

Since $\pi \equiv b\omega \pmod a$, $\chi_a(\pi) = \chi_a(b) \chi_a(\omega)$.

By Exercise 9.3,  as $a = 3m-1$, $\chi_a(\omega) = \omega^{M+N}$, where $M = m, N = 0$, so $$\chi_a(\omega) = \omega^m.$$

If $q$ is a rational prime, $q \equiv 2 \pmod 3$, and $q \wedge b = 1$, then $\chi_q(b) = 1$ (Prop. 9.3.4, Corollary).

If $p$ is a rational prime, $p \equiv 1 \pmod 3$ and $p \wedge b = 1$, then $p = \pi \overline{\pi}$, with $\pi$ primary prime in $D$ (and also $\overline{\pi}$), and by definition of $\chi_p$, $\chi_p(b) = \chi_\pi(b) \chi_{\overline{\pi}}(b)$.

As $\chi_{\overline{\pi}}(b) = \chi_{\overline{\pi}}(\overline{b}) = \overline{\chi_\pi(b)}$ (Prop. 9.3.4(b)), so $\chi_p(b) = 1$.
$a$ has a decomposition in prime  factors of the form :
$$a = \pm q_1q_2\cdots q_k p_1p_2\cdots p_l = \pm q_1q_2\cdots q_k \pi_1 \overline{\pi_1} \pi_2 \overline{\pi_2}\cdots \pi_l \overline{\pi_l},$$
where $q_i \equiv -1 , p_j \equiv 1 \pmod 3$, and  the $\pi_k$ are primary primes (since all these elements are primary, the symbol $\pm$ is $(-1)^{k-1}$).
Thus, by Ex. 9.21,
$$\chi_a(b) = \chi_{q_1}(b)\cdots \chi_{q_k(b)} \chi_{\pi_1}(b)\chi_{\overline{\pi_1}}(b)\cdots \chi_{\pi_l}(b)\chi_{\overline{\pi_l}}(b) = 1.$$
($a$ is relatively prime to $b$ in $\Z$ : if a rational prime $r$ divides $a,b$, then $r \mid \pi$ in $D$, thus $r \mid \overline{\pi}$, so $r^2 \mid \pi \overline{\pi} = p$ in $D$, thus $r^2 \mid p$ in $\Z$, which implies $r = p$.
 But then $p \mid \pi, N(p) \mid N(\pi), p^2 \mid p$ : this is absurd.
 As $a$ is relatively prime to $b$ in $\Z$, $ua + vb = 1,\ u,v \in \Z$, so $a,b$ are relatively prime in $D$, each prime factor $q_i,\pi_i,\overline{\pi_i}$ of $b$ is relatively prime to $a$.)
 
 We conclude that $\chi_a(b) = 1,\chi_a(\omega) = \omega^m$, so $\chi_\pi(a) = \chi_a(\pi) = \chi_a(b) \chi_a(\omega) = \omega^m$.
 $$\chi_\pi(a) = \omega^m.$$
 \item[(d)] 
 $$a+b = [(a+b) \omega] \omega^{-1},$$
and 
$$(a+b) \omega = (a+b\omega) +a\omega -a \equiv a(\omega-1)\pmod \pi,$$ thus
$$a+b \equiv -a(1-\omega) \omega^{-1} \ [\pi],$$
$$\chi_\pi (a+b) = \chi_\pi(1-\omega) \chi_\pi(a) \chi_\pi(\omega)^{-1},$$
$\chi_\pi(a) = \omega^m$ by (c), and $\chi_\pi(\omega) = \omega^{m+n}$(Ex. 9.3), thus

$$\chi_\pi(a+b) = \omega^{2n} \chi_\pi(1-\omega).$$
\end{enumerate}
\end{proof}

\paragraph{Ex. 9.25}

{\it Show that $\chi_{a+b}(\pi)$ may be computed as follows.
\begin{enumerate}
\item[(a)] $\chi_{a+b}(\pi) = \chi_{a+b}(1-\omega)$.
\item[(b)] $\chi_{a+b}(\pi) = \omega^{2(m+n)}$.
\end{enumerate}
}

\begin{proof}
\begin{enumerate}
\item[(a)] $\pi = a + b \omega$ and $a \equiv -b \pmod {a+b}$, thus $\pi \equiv -b(1-\omega) \pmod {a+b}$. So
$$\chi_{a+b}(\pi) = \chi_{a+b}(b) \chi_{a+b}(1-\omega).$$
As $a \wedge b = 1$, $(a+b) \wedge b = 1$ : as in Ex. 9.24, $\chi_{a+b}(b) = 1$. So
$$\chi_{a+b}(\pi) =  \chi_{a+b}(1-\omega).$$
\item[(b)] Since $\chi_{a+b}$ is a character of order 3,
\begin{align*}
\chi_{a+b}(1-\omega) &= (\chi_{a+b}((1-\omega)^2))^2\\
&=(\chi_{a+b}(-3\omega))^2\\
&=[\chi_{a+b}(3) \chi_{a+b}(\omega)]^2
\end{align*}

$\chi_{a+b}(3) = 1$ car $(a+b) \wedge 3 = (3(m+n)-1) \wedge 3 = 1$.

$\chi_{a+b}(\omega) = \omega^{m+n}$ (Ex. 9.19).

Conclusion : $$\chi_{a+b}(1-\omega) = \omega^{2(m+n)}.$$
\end{enumerate}
\end{proof}

\paragraph{Ex. 9.26}

{\it Combine the previous two exercises to conclude that $\chi_\pi(1-\omega) = \omega^{2m}$.
}

\begin{proof}
$\pi$ and $a+b$ are primary elements of $D$, so
$$\chi_\pi(a+b) = \chi_{a+b}(\pi).$$
By Exercises 9.24 and 9.24,
\begin{align*}
\chi_\pi(a+b) &= \omega^{2n} \chi_\pi(1-\omega)\\
\chi_{a+b}(\pi) &= \omega^{2(m+n)}
\end{align*}
Thus $\omega^{2n} \chi_\pi(1-\omega) = \omega^{2(m+n)}$.

In conclusion,
$$\chi_\pi(1-\omega) = \omega^{2m}.$$
\end{proof}


\end{document}